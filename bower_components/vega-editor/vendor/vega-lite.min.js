!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n;n="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,n.vl=e()}}(function(){var e;return function n(e,t,i){function a(o,l){if(!t[o]){if(!e[o]){var u="function"==typeof require&&require;if(!l&&u)return u(o,!0);if(r)return r(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var f=t[o]={exports:{}};e[o][0].call(f.exports,function(n){var t=e[o][1][n];return a(t?t:n)},f,f.exports,n,e,t,i)}return t[o].exports}for(var r="function"==typeof require&&require,o=0;o<i.length;o++)a(i[o]);return a}({1:[function(e,n,t){},{}],2:[function(n,t,i){!function(n,a){"object"==typeof i&&"undefined"!=typeof t?a(i):"function"==typeof e&&e.amd?e("d3-time",["exports"],a):a(n.d3_time={})}(this,function(e){"use strict";function n(e,t,i,o){function l(n){return e(n=new Date(+n)),n}return l.floor=l,l.round=function(n){var i=new Date(+n),a=new Date(n-1);return e(i),e(a),t(a,1),a-n>n-i?i:a},l.ceil=function(n){return e(n=new Date(n-1)),t(n,1),n},l.offset=function(e,n){return t(e=new Date(+e),null==n?1:Math.floor(n)),e},l.range=function(n,i,a){var r=[];if(n=new Date(n-1),i=new Date(+i),a=null==a?1:Math.floor(a),!(i>n&&a>0))return r;for(t(n,1),e(n),i>n&&r.push(new Date(+n));t(n,a),e(n),i>n;)r.push(new Date(+n));return r},l.filter=function(i){return n(function(n){for(;e(n),!i(n);)n.setTime(n-1)},function(e,n){for(;--n>=0;)for(;t(e,1),!i(e););})},i&&(l.count=function(n,t){return a.setTime(+n),r.setTime(+t),e(a),e(r),Math.floor(i(a,r))},l.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?l.filter(o?function(n){return o(n)%e===0}:function(n){return l.count(0,n)%e===0}):l:null}),l}function t(e){return n(function(n){n.setHours(0,0,0,0),n.setDate(n.getDate()-(n.getDay()+7-e)%7)},function(e,n){e.setDate(e.getDate()+7*n)},function(e,n){return(n-e-6e4*(n.getTimezoneOffset()-e.getTimezoneOffset()))/6048e5})}function i(e){return n(function(n){n.setUTCHours(0,0,0,0),n.setUTCDate(n.getUTCDate()-(n.getUTCDay()+7-e)%7)},function(e,n){e.setUTCDate(e.getUTCDate()+7*n)},function(e,n){return(n-e)/6048e5})}var a=new Date,r=new Date,o=n(function(){},function(e,n){e.setTime(+e+n)},function(e,n){return n-e});o.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?n(function(n){n.setTime(Math.floor(n/e)*e)},function(n,t){n.setTime(+n+t*e)},function(n,t){return(t-n)/e}):o:null};var l=n(function(e){e.setMilliseconds(0)},function(e,n){e.setTime(+e+1e3*n)},function(e,n){return(n-e)/1e3},function(e){return e.getSeconds()}),u=n(function(e){e.setSeconds(0,0)},function(e,n){e.setTime(+e+6e4*n)},function(e,n){return(n-e)/6e4},function(e){return e.getMinutes()}),c=n(function(e){e.setMinutes(0,0,0)},function(e,n){e.setTime(+e+36e5*n)},function(e,n){return(n-e)/36e5},function(e){return e.getHours()}),f=n(function(e){e.setHours(0,0,0,0)},function(e,n){e.setDate(e.getDate()+n)},function(e,n){return(n-e-6e4*(n.getTimezoneOffset()-e.getTimezoneOffset()))/864e5},function(e){return e.getDate()-1}),s=t(0),d=t(1),p=t(2),m=t(3),g=t(4),h=t(5),O=t(6),T=n(function(e){e.setHours(0,0,0,0),e.setDate(1)},function(e,n){e.setMonth(e.getMonth()+n)},function(e,n){return n.getMonth()-e.getMonth()+12*(n.getFullYear()-e.getFullYear())},function(e){return e.getMonth()}),E=n(function(e){e.setHours(0,0,0,0),e.setMonth(0,1)},function(e,n){e.setFullYear(e.getFullYear()+n)},function(e,n){return n.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()}),y=n(function(e){e.setUTCMilliseconds(0)},function(e,n){e.setTime(+e+1e3*n)},function(e,n){return(n-e)/1e3},function(e){return e.getUTCSeconds()}),v=n(function(e){e.setUTCSeconds(0,0)},function(e,n){e.setTime(+e+6e4*n)},function(e,n){return(n-e)/6e4},function(e){return e.getUTCMinutes()}),S=n(function(e){e.setUTCMinutes(0,0,0)},function(e,n){e.setTime(+e+36e5*n)},function(e,n){return(n-e)/36e5},function(e){return e.getUTCHours()}),A=n(function(e){e.setUTCHours(0,0,0,0)},function(e,n){e.setUTCDate(e.getUTCDate()+n)},function(e,n){return(n-e)/864e5},function(e){return e.getUTCDate()-1}),N=i(0),R=i(1),M=i(2),C=i(3),L=i(4),x=i(5),I=i(6),D=n(function(e){e.setUTCHours(0,0,0,0),e.setUTCDate(1)},function(e,n){e.setUTCMonth(e.getUTCMonth()+n)},function(e,n){return n.getUTCMonth()-e.getUTCMonth()+12*(n.getUTCFullYear()-e.getUTCFullYear())},function(e){return e.getUTCMonth()}),b=n(function(e){e.setUTCHours(0,0,0,0),e.setUTCMonth(0,1)},function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n)},function(e,n){return n.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()}),U=o.range,k=l.range,Y=u.range,_=c.range,H=f.range,w=s.range,X=d.range,P=p.range,W=m.range,F=g.range,z=h.range,G=O.range,Z=s.range,V=T.range,Q=E.range,B=o,j=U,q=y.range,K=v.range,$=S.range,J=A.range,ee=N.range,ne=R.range,te=M.range,ie=C.range,ae=L.range,re=x.range,oe=I.range,le=N.range,ue=D.range,ce=b.range,fe="0.1.0";e.version=fe,e.milliseconds=U,e.seconds=k,e.minutes=Y,e.hours=_,e.days=H,e.sundays=w,e.mondays=X,e.tuesdays=P,e.wednesdays=W,e.thursdays=F,e.fridays=z,e.saturdays=G,e.weeks=Z,e.months=V,e.years=Q,e.utcMillisecond=B,e.utcMilliseconds=j,e.utcSeconds=q,e.utcMinutes=K,e.utcHours=$,e.utcDays=J,e.utcSundays=ee,e.utcMondays=ne,e.utcTuesdays=te,e.utcWednesdays=ie,e.utcThursdays=ae,e.utcFridays=re,e.utcSaturdays=oe,e.utcWeeks=le,e.utcMonths=ue,e.utcYears=ce,e.millisecond=o,e.second=l,e.minute=u,e.hour=c,e.day=f,e.sunday=s,e.monday=d,e.tuesday=p,e.wednesday=m,e.thursday=g,e.friday=h,e.saturday=O,e.week=s,e.month=T,e.year=E,e.utcSecond=y,e.utcMinute=v,e.utcHour=S,e.utcDay=A,e.utcSunday=N,e.utcMonday=R,e.utcTuesday=M,e.utcWednesday=C,e.utcThursday=L,e.utcFriday=x,e.utcSaturday=I,e.utcWeek=N,e.utcMonth=D,e.utcYear=b,e.interval=n})},{}],3:[function(e,n,t){function i(e){if(!e)throw Error("Missing binning options.");var n,t,i,l,u,c,f,s=e.maxbins||15,d=e.base||10,p=Math.log(d),m=e.div||[5,2],g=e.min,h=e.max,O=h-g;if(e.step)n=e.step;else if(e.steps)n=e.steps[Math.min(e.steps.length-1,a(e.steps,O/s,0,e.steps.length))];else{for(t=Math.ceil(Math.log(s)/p),i=e.minstep||0,n=Math.max(i,Math.pow(d,Math.round(Math.log(O)/p)-t));Math.ceil(O/n)>s;)n*=d;for(c=0;c<m.length;++c)u=n/m[c],u>=i&&s>=O/u&&(n=u)}return u=Math.log(n),l=u>=0?0:~~(-u/p)+1,f=Math.pow(d,-l-1),g=Math.min(g,Math.floor(g/n+f)*n),h=Math.ceil(h/n)*n,{start:g,stop:h,step:n,unit:{precision:l},value:r,index:o}}function a(e,n,t,i){for(;i>t;){var a=t+i>>>1;c.cmp(e[a],n)<0?t=a+1:i=a}return t}function r(e){return this.step*Math.floor(e/this.step+s)}function o(e){return Math.floor((e-this.start)/this.step+s)}function l(e){return this.unit.date(r.call(this,e))}function u(e){return o.call(this,this.unit.unit(e))}var c=e("../util"),f=e("../time"),s=1e-15;i.date=function(e){if(!e)throw Error("Missing date binning options.");var n=e.utc?f.utc:f,t=e.min,a=e.max,r=e.maxbins||20,o=e.minbins||4,c=+a-+t,s=e.unit?n[e.unit]:n.find(c,o,r),d=i({min:null!=s.min?s.min:s.unit(t),max:null!=s.max?s.max:s.unit(a),maxbins:r,minstep:s.minstep,steps:s.step});return d.unit=s,d.index=u,e.raw||(d.value=l),d},n.exports=i},{"../time":5,"../util":6}],4:[function(e,n,t){var i=e("./util"),a=n.exports;a.repeat=function(e,n){var t,i=Array(n);for(t=0;n>t;++t)i[t]=e;return i},a.zeros=function(e){return a.repeat(0,e)},a.range=function(e,n,t){if(arguments.length<3&&(t=1,arguments.length<2&&(n=e,e=0)),(n-e)/t==1/0)throw new Error("Infinite range");var i,a=[],r=-1;if(0>t)for(;(i=e+t*++r)>n;)a.push(i);else for(;(i=e+t*++r)<n;)a.push(i);return a},a.random={},a.random.uniform=function(e,n){void 0===n&&(n=void 0===e?1:e,e=0);var t=n-e,i=function(){return e+t*Math.random()};return i.samples=function(e){return a.zeros(e).map(i)},i.pdf=function(i){return i>=e&&n>=i?1/t:0},i.cdf=function(i){return e>i?0:i>n?1:(i-e)/t},i.icdf=function(n){return n>=0&&1>=n?e+n*t:NaN},i},a.random.integer=function(e,n){void 0===n&&(n=e,e=0);var t=n-e,i=function(){return e+Math.floor(t*Math.random())};return i.samples=function(e){return a.zeros(e).map(i)},i.pdf=function(i){return i===Math.floor(i)&&i>=e&&n>i?1/t:0},i.cdf=function(i){var a=Math.floor(i);return e>a?0:a>=n?1:(a-e+1)/t},i.icdf=function(n){return n>=0&&1>=n?e-1+Math.floor(n*t):NaN},i},a.random.normal=function(e,n){e=e||0,n=n||1;var t,i=function(){var i,a,r=0,o=0;if(void 0!==t)return r=t,t=void 0,r;do r=2*Math.random()-1,o=2*Math.random()-1,i=r*r+o*o;while(0===i||i>1);return a=Math.sqrt(-2*Math.log(i)/i),t=e+o*a*n,e+r*a*n};return i.samples=function(e){return a.zeros(e).map(i)},i.pdf=function(t){var i=Math.exp(Math.pow(t-e,2)/(-2*Math.pow(n,2)));return 1/(n*Math.sqrt(2*Math.PI))*i},i.cdf=function(t){var i,a=(t-e)/n,r=Math.abs(a);if(r>37)i=0;else{var o,l=Math.exp(-r*r/2);7.07106781186547>r?(o=.0352624965998911*r+.700383064443688,o=o*r+6.37396220353165,o=o*r+33.912866078383,o=o*r+112.079291497871,o=o*r+221.213596169931,o=o*r+220.206867912376,i=l*o,o=.0883883476483184*r+1.75566716318264,o=o*r+16.064177579207,o=o*r+86.7807322029461,o=o*r+296.564248779674,o=o*r+637.333633378831,o=o*r+793.826512519948,o=o*r+440.413735824752,i/=o):(o=r+.65,o=r+4/o,o=r+3/o,o=r+2/o,o=r+1/o,i=l/o/2.506628274631)}return a>0?1-i:i},i.icdf=function(t){if(0>=t||t>=1)return NaN;var i=2*t-1,a=8*(Math.PI-3)/(3*Math.PI*(4-Math.PI)),r=2/(Math.PI*a)+Math.log(1-Math.pow(i,2))/2,o=Math.log(1-i*i)/a,l=(i>0?1:-1)*Math.sqrt(Math.sqrt(r*r-o)-r);return e+n*Math.SQRT2*l},i},a.random.bootstrap=function(e,n){var t=e.filter(i.isValid),r=t.length,o=n?a.random.normal(0,n):null,l=function(){return t[~~(Math.random()*r)]+(o?o():0)};return l.samples=function(e){return a.zeros(e).map(l)},l}},{"./util":6}],5:[function(e,n,t){function i(e){return c.setTime(+e),c}function a(e,n,t,i,a,r){var o={type:e,date:n,unit:t};return i?o.step=i:o.minstep=1,null!=a&&(o.min=a),null!=r&&(o.max=r),o}function r(e,n,t,i,r,o){return a(e,function(e){return n.offset(t,e)},function(e){return n.count(t,e)},i,r,o)}function o(e,n,t,i){var a,r,o,l=m[0];for(a=1,r=m.length;r>a;++a)if(l=m[a],n>l[0]){if(o=n/l[0],o>i)return e[m[a-1][1]];if(o>=t)return e[l[1]]}return e[m[r-1][1]]}function l(e){var n,t,i={};for(n=0,t=e.length;t>n;++n)i[e[n].type]=e[n];return i.find=function(n,t,i){return o(e,n,t,i)},i}var u=e("d3-time"),c=new Date,f=new Date(0,0,1).setFullYear(0),s=new Date(Date.UTC(0,0,1)).setUTCFullYear(0),d=[r("second",u.second,f),r("minute",u.minute,f),r("hour",u.hour,f),r("day",u.day,f,[1,7]),r("month",u.month,f,[1,3,6]),r("year",u.year,f),a("seconds",function(e){return new Date(1970,0,1,0,0,e)},function(e){return i(e).getSeconds()},null,0,59),a("minutes",function(e){return new Date(1970,0,1,0,e)},function(e){return i(e).getMinutes()},null,0,59),a("hours",function(e){return new Date(1970,0,1,e)},function(e){return i(e).getHours()},null,0,23),a("weekdays",function(e){return new Date(1970,0,4+e)},function(e){return i(e).getDay()},[1],0,6),a("dates",function(e){return new Date(1970,0,e)},function(e){return i(e).getDate()},[1],1,31),a("months",function(e){return new Date(1970,e%12,1)},function(e){return i(e).getMonth()},[1],0,11)],p=[r("second",u.utcSecond,s),r("minute",u.utcMinute,s),r("hour",u.utcHour,s),r("day",u.utcDay,s,[1,7]),r("month",u.utcMonth,s,[1,3,6]),r("year",u.utcYear,s),a("seconds",function(e){return new Date(Date.UTC(1970,0,1,0,0,e))},function(e){return i(e).getUTCSeconds()},null,0,59),a("minutes",function(e){return new Date(Date.UTC(1970,0,1,0,e))},function(e){return i(e).getUTCMinutes()},null,0,59),a("hours",function(e){return new Date(Date.UTC(1970,0,1,e))},function(e){return i(e).getUTCHours()},null,0,23),a("weekdays",function(e){return new Date(Date.UTC(1970,0,4+e))},function(e){return i(e).getUTCDay()},[1],0,6),a("dates",function(e){return new Date(Date.UTC(1970,0,e))},function(e){return i(e).getUTCDate()},[1],1,31),a("months",function(e){return new Date(Date.UTC(1970,e%12,1))},function(e){return i(e).getUTCMonth()},[1],0,11)],m=[[31536e6,5],[7776e6,4],[2592e6,4],[12096e5,3],[6048e5,3],[1728e5,3],[864e5,3],[432e5,2],[216e5,2],[108e5,2],[36e5,2],[18e5,1],[9e5,1],[3e5,1],[6e4,1],[3e4,0],[15e3,0],[5e3,0],[1e3,0]];n.exports=l(d),n.exports.utc=l(p)},{"d3-time":2}],6:[function(e,n,t){(function(e){function t(e){return e.replace(u,"$1\\'")}function i(e,n){var t,i="";for(t=0;e>t;++t)i+=n;return i}function a(e,n,t){var i=0,a=e.split(f);return e=t?(a=a.reverse()).filter(function(e){return i+=e.length,n>=i}).reverse():a.filter(function(e){return i+=e.length,n>=i}),e.length?e.join("").trim():a[0].slice(0,n)}var r=n.exports,o="__name__";r.namedfunc=function(e,n){return n[o]=e,n},r.name=function(e){return null==e?null:e[o]},r.identity=function(e){return e},r["true"]=r.namedfunc("true",function(){return!0}),r["false"]=r.namedfunc("false",function(){return!1}),r.duplicate=function(e){return JSON.parse(JSON.stringify(e))},r.equal=function(e,n){return JSON.stringify(e)===JSON.stringify(n)},r.extend=function(e){for(var n,t,i=1,a=arguments.length;a>i;++i){n=arguments[i];for(t in n)e[t]=n[t]}return e},r.length=function(e){return null!=e&&null!=e.length?e.length:null},r.keys=function(e){var n,t=[];for(n in e)t.push(n);return t},r.vals=function(e){var n,t=[];for(n in e)t.push(e[n]);return t},r.toMap=function(e,n){return(n=r.$(n))?e.reduce(function(e,t){return e[n(t)]=1,e},{}):e.reduce(function(e,n){return e[n]=1,e},{})},r.keystr=function(e){var n=e.length;if(!n)return"";for(var t=String(e[0]),i=1;n>i;++i)t+="|"+String(e[i]);return t};var l=Object.prototype.toString;r.isObject=function(e){return e===Object(e)},r.isFunction=function(e){return"[object Function]"===l.call(e)},r.isString=function(e){return"string"==typeof value||"[object String]"===l.call(e)},r.isArray=Array.isArray||function(e){return"[object Array]"===l.call(e)},r.isNumber=function(e){return"number"==typeof e||"[object Number]"===l.call(e)},r.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"==l.call(e)},r.isDate=function(e){return"[object Date]"===l.call(e)},r.isValid=function(e){return null!=e&&e===e},r.isBuffer="function"==typeof e&&e.isBuffer||r["false"],r.number=function(e){return null==e||""===e?null:+e},r["boolean"]=function(e){return null==e||""===e?null:"false"===e?!1:!!e},r.date=function(e,n){var t=n?n:Date;return null==e||""===e?null:t.parse(e)},r.array=function(e){return null!=e?r.isArray(e)?e:[e]:[]},r.str=function(e){return r.isArray(e)?"["+e.map(r.str)+"]":r.isObject(e)?JSON.stringify(e):r.isString(e)?"'"+t(e)+"'":e};var u=/(^|[^\\])'/g,c=/\[(.*?)\]|[^.\[]+/g;r.field=function(e){return String(e).match(c).map(function(e){return"["!==e[0]?e:"'"!==e[1]&&'"'!==e[1]?e.slice(1,-1):e.slice(2,-2).replace(/\\(["'])/g,"$1")})},r.accessor=function(e){var n;return null==e||r.isFunction(e)?e:r.namedfunc(e,(n=r.field(e)).length>1?function(e){return n.reduce(function(e,n){return e[n]},e)}:function(n){return n[e]})},r.$=r.accessor,r.mutator=function(e){var n;return r.isString(e)&&(n=r.field(e)).length>1?function(e,t){for(var i=0;i<n.length-1;++i)e=e[n[i]];e[n[i]]=t}:function(n,t){n[e]=t}},r.$func=function(e,n){return function(t){t=r.$(t)||r.identity;var i=e+(r.name(t)?"_"+r.name(t):"");return r.namedfunc(i,function(e){return n(t(e))})}},r.$valid=r.$func("valid",r.isValid),r.$length=r.$func("length",r.length),r.$in=function(e,n){e=r.$(e);var t=r.isArray(n)?r.toMap(n):n;return function(n){return!!t[e(n)]}},r.comparator=function(e){var n=[];return void 0===e&&(e=[]),e=r.array(e).map(function(e){var t=1;return"-"===e[0]?(t=-1,e=e.slice(1)):"+"===e[0]&&(t=1,e=e.slice(1)),n.push(t),r.accessor(e)}),function(t,i){var a,r,o,l,u;for(a=0,r=e.length;r>a;++a){if(o=e[a],l=o(t),u=o(i),u>l)return-1*n[a];if(l>u)return n[a]}return 0}},r.cmp=function(e,n){return n>e?-1:e>n?1:e>=n?0:null===e?-1:null===n?1:NaN},r.numcmp=function(e,n){return e-n},r.stablesort=function(e,n,t){var i=e.reduce(function(e,n,i){return e[t(n)]=i,e},{});return e.sort(function(e,a){var r=n(e),o=n(a);return o>r?-1:r>o?1:i[t(e)]-i[t(a)]}),e},r.pad=function(e,n,t,a){a=a||" ";var r=n-e.length;if(0>=r)return e;switch(t){case"left":return i(r,a)+e;case"middle":case"center":return i(Math.floor(r/2),a)+e+i(Math.ceil(r/2),a);default:return e+i(r,a)}},r.truncate=function(e,n,t,i,r){var o=e.length;if(n>=o)return e;r=void 0!==r?String(r):"…";var l=Math.max(0,n-r.length);switch(t){case"left":return r+(i?a(e,l,1):e.slice(o-l));case"middle":case"center":var u=Math.ceil(l/2),c=Math.floor(l/2);return(i?a(e,u):e.slice(0,u))+r+(i?a(e,c,1):e.slice(o-c));default:return(i?a(e,l):e.slice(0,l))+r}};var f=/([\u0009\u000A\u000B\u000C\u000D\u0020\u00A0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u2028\u2029\u3000\uFEFF])/}).call(this,e("buffer").Buffer)},{buffer:1}],7:[function(e,n,t){!function(e){e[e.VALUES="values"]="VALUES",e[e.COUNT="count"]="COUNT",e[e.VALID="valid"]="VALID",e[e.MISSING="missing"]="MISSING",e[e.DISTINCT="distinct"]="DISTINCT",e[e.SUM="sum"]="SUM",e[e.MEAN="mean"]="MEAN",e[e.AVERAGE="average"]="AVERAGE",e[e.VARIANCE="variance"]="VARIANCE",e[e.VARIANCEP="variancep"]="VARIANCEP",e[e.STDEV="stdev"]="STDEV",e[e.STDEVP="stdevp"]="STDEVP",e[e.MEDIAN="median"]="MEDIAN",e[e.Q1="q1"]="Q1",e[e.Q3="q3"]="Q3",e[e.MODESKEW="modeskew"]="MODESKEW",e[e.MIN="min"]="MIN",e[e.MAX="max"]="MAX",e[e.ARGMIN="argmin"]="ARGMIN",e[e.ARGMAX="argmax"]="ARGMAX"}(t.AggregateOp||(t.AggregateOp={}));var i=t.AggregateOp;t.AGGREGATE_OPS=[i.VALUES,i.COUNT,i.VALID,i.MISSING,i.DISTINCT,i.SUM,i.MEAN,i.AVERAGE,i.VARIANCE,i.VARIANCEP,i.STDEV,i.STDEVP,i.MEDIAN,i.Q1,i.Q3,i.MODESKEW,i.MIN,i.MAX,i.ARGMIN,i.ARGMAX],t.SHARED_DOMAIN_OPS=[i.MEAN,i.AVERAGE,i.STDEV,i.STDEVP,i.MEDIAN,i.Q1,i.Q3,i.MIN,i.MAX]},{}],8:[function(e,n,t){!function(e){e[e.TOP="top"]="TOP",e[e.RIGHT="right"]="RIGHT",e[e.LEFT="left"]="LEFT",e[e.BOTTOM="bottom"]="BOTTOM"}(t.AxisOrient||(t.AxisOrient={}));t.AxisOrient;t.defaultAxisConfig={offset:void 0,grid:void 0,labels:!0,labelMaxLength:25,tickSize:void 0,characterWidth:6},t.defaultFacetAxisConfig={axisWidth:0,labels:!0,grid:!1,tickSize:0}},{}],9:[function(e,n,t){function i(e){switch(e){case a.ROW:case a.COLUMN:case a.SIZE:case a.SHAPE:return 6;default:return 10}}var a=e("./channel");t.autoMaxBins=i},{"./channel":10}],10:[function(e,n,t){function i(e,n){return!!a(e)[n]}function a(e){switch(e){case t.X:case t.Y:case t.COLOR:case t.DETAIL:case t.ORDER:case t.ROW:case t.COLUMN:return{point:!0,tick:!0,circle:!0,square:!0,bar:!0,line:!0,area:!0,text:!0};case t.SIZE:return{point:!0,tick:!0,circle:!0,square:!0,bar:!0,text:!0};case t.SHAPE:return{point:!0};case t.TEXT:return{text:!0};case t.PATH:return{line:!0}}return{}}function r(e){switch(e){case t.X:case t.Y:case t.COLOR:case t.LABEL:return{measure:!0,dimension:!0};case t.ROW:case t.COLUMN:case t.SHAPE:case t.DETAIL:return{measure:!1,dimension:!0};case t.SIZE:case t.TEXT:return{measure:!0,dimension:!1};case t.PATH:return{measure:!1,dimension:!0}}throw new Error("Invalid encoding channel"+e)}function o(e){return!l.contains([t.DETAIL,t.PATH,t.TEXT,t.LABEL,t.ORDER],e)}var l=e("./util");!function(e){e[e.X="x"]="X",e[e.Y="y"]="Y",e[e.ROW="row"]="ROW",e[e.COLUMN="column"]="COLUMN",e[e.SHAPE="shape"]="SHAPE",e[e.SIZE="size"]="SIZE",e[e.COLOR="color"]="COLOR",e[e.TEXT="text"]="TEXT",e[e.DETAIL="detail"]="DETAIL",e[e.LABEL="label"]="LABEL",e[e.PATH="path"]="PATH",e[e.ORDER="order"]="ORDER"}(t.Channel||(t.Channel={}));var u=t.Channel;t.X=u.X,t.Y=u.Y,t.ROW=u.ROW,t.COLUMN=u.COLUMN,t.SHAPE=u.SHAPE,t.SIZE=u.SIZE,t.COLOR=u.COLOR,t.TEXT=u.TEXT,t.DETAIL=u.DETAIL,t.LABEL=u.LABEL,t.PATH=u.PATH,t.ORDER=u.ORDER,t.CHANNELS=[t.X,t.Y,t.ROW,t.COLUMN,t.SIZE,t.SHAPE,t.COLOR,t.PATH,t.ORDER,t.TEXT,t.DETAIL,t.LABEL],t.supportMark=i,t.getSupportedMark=a,t.getSupportedRole=r,t.hasScale=o},{"./util":42}],11:[function(e,n,t){var i=e("../config"),a=e("../channel"),r=e("../data"),o=e("../fielddef"),l=e("../encoding"),u=e("../mark"),c=e("../type"),f=e("../util"),s=e("./config"),d=e("./stack"),p=e("./scale"),m=e("../scale"),g=e("../aggregate"),h=e("../channel"),O=function(){function e(e){var n=this;this._spec=e;var t=this._spec.mark,r=this._spec.encoding=this._spec.encoding||{},o=this._config=f.mergeDeep(f.duplicate(i.defaultConfig),e.config);l.forEach(this._spec.encoding,function(e,n){a.supportMark(n,this._spec.mark)||(console.warn(n,"dropped as it is incompatible with",this._spec.mark),delete this._spec.encoding[n].field),e.type&&(e.type=c.getFullName(e.type)),n!==a.PATH&&n!==a.ORDER||e.aggregate||e.type!==c.QUANTITATIVE||(e.aggregate=g.AggregateOp.MIN)},this);var h=this._scale=[a.X,a.Y,a.COLOR,a.SHAPE,a.SIZE,a.ROW,a.COLUMN].reduce(function(e,i){if(l.has(r,i)){var c=r[i].scale||{},s=r[i],d=p.scaleType(c,s,i,t);f.contains([a.ROW,a.COLUMN],i)?e[i]=f.extend({type:d,round:o.facet.scale.round,padding:i===a.ROW&&n.has(a.Y)||i===a.COLUMN&&n.has(a.X)?o.facet.scale.padding:0},c):e[i]=f.extend({type:d,round:o.scale.round,padding:o.scale.padding,includeRawDomain:o.scale.includeRawDomain,bandSize:i===a.X&&d===m.ScaleType.ORDINAL&&t===u.TEXT?o.scale.textBandWidth:o.scale.bandSize},c)}return e},{});this._axis=[a.X,a.Y,a.ROW,a.COLUMN].reduce(function(e,n){if(l.has(r,n)){var t=r[n].axis;t!==!1&&(e[n]=f.extend({},n===a.X||n===a.Y?o.axis:o.facet.axis,t===!0?{}:t||{}))}return e},{}),this._legend=[a.COLOR,a.SHAPE,a.SIZE].reduce(function(e,n){if(l.has(r,n)){var t=r[n].legend;t!==!1&&(e[n]=f.extend({},o.legend,t===!0?{}:t||{}))}return e},{}),this._stack=d.compileStackProperties(t,r,h,o),this._config.mark=s.compileMarkConfig(t,r,o,this._stack)}return e.prototype.stack=function(){return this._stack},e.prototype.toSpec=function(e,n){var t,i=f.duplicate(this._spec.encoding);return t={mark:this._spec.mark,encoding:i},e||(t.config=f.duplicate(this._spec.config)),n||(t.data=f.duplicate(this._spec.data)),t},e.prototype.cellWidth=function(){return(this.isFacet()?this.config().facet.cell.width:null)||this.config().cell.width},e.prototype.cellHeight=function(){return(this.isFacet()?this.config().facet.cell.height:null)||this.config().cell.height},e.prototype.mark=function(){return this._spec.mark},e.prototype.spec=function(){return this._spec},e.prototype.has=function(e){return l.has(this._spec.encoding,e)},e.prototype.encoding=function(){return this._spec.encoding},e.prototype.fieldDef=function(e){return this._spec.encoding[e]||{}},e.prototype.field=function(e,n){void 0===n&&(n={});var t=this.fieldDef(e),i=this.scale(e);return t.bin&&(n=f.extend({binSuffix:p.scaleType(i,t,e,this.mark())===m.ScaleType.ORDINAL?"_range":"_start"},n)),o.field(t,n)},e.prototype.channelWithScales=function(){var e=this;return h.CHANNELS.filter(function(n){return!!e.scale(n)})},e.prototype.reduce=function(e,n,t){return l.reduce(this._spec.encoding,e,n,t)},e.prototype.forEach=function(e,n){l.forEach(this._spec.encoding,e,n)},e.prototype.isOrdinalScale=function(e){var n=this.fieldDef(e),t=this.scale(e);return this.has(e)&&p.scaleType(t,n,e,this.mark())===m.ScaleType.ORDINAL},e.prototype.isFacet=function(){return this.has(a.ROW)||this.has(a.COLUMN)},e.prototype.dataTable=function(){return l.isAggregate(this._spec.encoding)?r.SUMMARY:r.SOURCE},e.prototype.data=function(){return this._spec.data},e.prototype.transform=function(){return this._spec.transform||{}},e.prototype.config=function(){return this._config},e.prototype.sort=function(e){return this._spec.encoding[e].sort},e.prototype.scale=function(e){return this._scale[e]},e.prototype.axis=function(e){return this._axis[e]},e.prototype.legend=function(e){return this._legend[e]},e.prototype.scaleName=function(e){var n=this.spec().name;return(n?n+"-":"")+e},e}();t.Model=O},{"../aggregate":7,"../channel":10,"../config":30,"../data":31,"../encoding":32,"../fielddef":33,"../mark":35,"../scale":36,"../type":41,"../util":42,"./config":15,"./scale":27,"./stack":28}],12:[function(e,n,t){function i(e,n){var i=e===m.COLUMN,a=e===m.ROW,r=i?"x":a?"y":e,o={type:r,scale:n.scaleName(e),grid:!0,tickSize:0,properties:{labels:{text:{value:""}},axis:{stroke:{value:"transparent"}}}},l=n.axis(e);return["layer","ticks","values","subdivide"].forEach(function(i){var a,r=(a=t[i])?a(n,e,o):l[i];void 0!==r&&(o[i]=r)}),o}function a(e,n){var i=e===m.COLUMN,a=e===m.ROW,r=i?"x":a?"y":e,o=n.axis(e),l={type:r,scale:n.scaleName(e)};O.extend(l,T.formatMixins(n,e,n.axis(e).format)),["grid","layer","offset","orient","tickSize","ticks","title","tickPadding","tickSize","tickSizeMajor","tickSizeMinor","tickSizeEnd","titleOffset","values","subdivide"].forEach(function(i){var a,r=(a=t[i])?a(n,e,l):o[i];void 0!==r&&(l[i]=r)});var u=n.axis(e).properties||{};return["axis","labels","grid","title","ticks","majorTicks","minorTicks"].forEach(function(t){var i=E[t]?E[t](n,e,u[t]||{},l):u[t];void 0!==i&&(l.properties=l.properties||{},l.properties[t]=i)}),l}function r(e,n){return e.axis(n).offset}function o(e,n){var t=e.axis(n).grid;return void 0!==t?t:!e.isOrdinalScale(n)&&!e.fieldDef(n).bin}function l(e,n){return n!==m.ROW&&n!==m.COLUMN?o(e,n)&&(n===m.Y||n===m.X)&&!(e.has(m.COLUMN)||e.has(m.ROW)):void 0}function u(e,n,t){var i=e.axis(n).layer;return void 0!==i?i:t.grid?"back":void 0}function c(e,n){var t=e.axis(n).orient;return t?t:n===m.COLUMN?p.AxisOrient.TOP:n===m.ROW&&e.has(m.Y)&&e.axis(m.Y).orient!==p.AxisOrient.RIGHT?p.AxisOrient.RIGHT:void 0}function f(e,n){var t=e.axis(n).ticks;return void 0!==t?t:n!==m.X||e.fieldDef(n).bin?void 0:5}function s(e,n){var t=e.axis(n).tickSize;return void 0!==t?t:void 0}function d(e,n){var t=e.axis(n);if(void 0!==t.title)return t.title;var i,a=g.title(e.fieldDef(n));return t.titleMaxLength?i=t.titleMaxLength:n!==m.X||e.isOrdinalScale(m.X)?n!==m.Y||e.isOrdinalScale(m.Y)||(i=e.cellHeight()/e.axis(m.Y).characterWidth):i=e.cellWidth()/e.axis(m.X).characterWidth,i?O.truncate(a,i):a}var p=e("../axis"),m=e("../channel"),g=e("../fielddef"),h=e("../type"),O=e("../util"),T=e("./common");t.compileInnerAxis=i,t.compileAxis=a,t.offset=r,t.gridShow=o,t.grid=l,t.layer=u,t.orient=c,t.ticks=f,t.tickSize=s,t.title=d;var E;!function(e){function n(e,n,t,i){var a=e.axis(n);return O.extend(void 0!==a.axisWidth?{strokeWidth:{value:a.axisWidth}}:{},t||{})}function t(e,n,t,i){var a=e.fieldDef(n),r=e.axis(n);return r.labels?(O.contains([h.NOMINAL,h.ORDINAL],a.type)&&r.labelMaxLength&&(t=O.extend({text:{template:"{{ datum.data | truncate:"+r.labelMaxLength+"}}"}},t||{})),void 0!==r.labelAngle?t.angle={value:r.labelAngle}:n!==m.X||!g.isDimension(a)&&a.type!==h.TEMPORAL?n===m.ROW&&e.has(m.X)&&(t.angle={value:"left"===i.orient?270:90}):t.angle={value:270},void 0!==r.labelAlign?t.align={value:r.labelAlign}:t.angle&&(270===t.angle.value?t.align={value:"top"===i.orient?"left":"x"===i.type?"right":"center"}:90===t.angle.value&&(t.align={value:"center"})),void 0!==r.labelBaseline?t.baseline={value:r.labelBaseline}:t.angle&&(270===t.angle.value?t.baseline={value:"x"===i.type?"middle":"bottom"}:90===t.angle.value&&(t.baseline={value:"bottom"})),t||void 0):O.extend({text:""},t)}e.axis=n,e.labels=t}(E=t.properties||(t.properties={}))},{"../axis":8,"../channel":10,"../fielddef":33,"../type":41,"../util":42,"./common":13}],13:[function(e,n,t){function i(e,n){var i=n.config().mark.filled,a=n.fieldDef(f.COLOR);r(e,n,t.FILL_STROKE_CONFIG);var o;n.has(f.COLOR)?o={scale:n.scaleName(f.COLOR),field:n.field(f.COLOR,a.type===p.ORDINAL?{prefn:"rank_"}:{})}:a&&a.value&&(o={value:a.value}),void 0!==o?i?e.fill=o:e.stroke=o:e[i?"fill":"stroke"]=e[i?"fill":"stroke"]||{value:n.config().mark.color}}function a(e,n,t){t.forEach(function(t){var i=n[t];void 0!==i&&(e[t]={value:i})})}function r(e,n,t){a(e,n.config().mark,t)}function o(e,n,t){var i=e.fieldDef(n);if(!g.contains([p.QUANTITATIVE,p.TEMPORAL],i.type))return{};var a={};if(i.type===p.TEMPORAL&&(a.formatType="time"),void 0!==t)a.format=t;else switch(i.type){case p.QUANTITATIVE:a.format=e.config().numberFormat;break;case p.TEMPORAL:a.format=c(e,n)||e.config().timeFormat}if(n===f.TEXT){var r=(a.formatType||"number")+(a.format?":'"+a.format+"'":"");return{text:{template:"{{"+e.field(n,{datum:!0})+" | "+r+"}}"}}}return a}function l(e,n,t){switch(n){case f.ROW:case f.COLUMN:case f.X:case f.Y:return e.axis(n).shortTimeLabels;case f.COLOR:case f.SHAPE:case f.SIZE:return e.legend(n).shortTimeLabels;case f.TEXT:return e.config().mark.shortTimeLabels;case f.LABEL:}return!1}function u(e){return(e.sort===d.SortOrder.DESCENDING?"-":"")+s.field(e)}function c(e,n){var t=e.fieldDef(n);return m.format(t.timeUnit,l(e,n,t))}var f=e("../channel"),s=e("../fielddef"),d=e("../sort"),p=e("../type"),m=e("./time"),g=e("../util");t.FILL_STROKE_CONFIG=["fill","fillOpacity","stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","opacity"],t.applyColorAndOpacity=i,t.applyConfig=a,t.applyMarkConfig=r,t.formatMixins=o,t.sortField=u,t.timeFormat=c},{"../channel":10,"../fielddef":33,"../sort":38,"../type":41,"../util":42,"./time":29}],14:[function(e,n,t){function i(e){var n=new r.Model(e),t=n.config(),i=m.extend(e.name?{name:e.name}:{},{width:1,height:1,padding:"auto"},t.viewport?{viewport:t.viewport}:{},t.background?{background:t.background}:{},{data:l.compileData(n).concat([u.compileLayoutData(n)]),marks:[a(n)]});return{spec:i}}function a(e){var n=e.spec(),t=m.extend({name:n.name?n.name+"-root":"root",type:"group"},n.description?{description:n.description}:{},{from:{data:g.LAYOUT},properties:{update:{width:{field:"width"},height:{field:"height"}}}}),i=s.compileMark(e);if(e.has(h.ROW)||e.has(h.COLUMN))m.extend(t,c.facetMixins(e,i));else{p.applyConfig(t.properties.update,e.config().cell,p.FILL_STROKE_CONFIG.concat(["clip"])),t.marks=i,t.scales=d.compileScales(e);var a=(e.has(h.X)&&e.axis(h.X)?[o.compileAxis(h.X,e)]:[]).concat(e.has(h.Y)&&e.axis(h.Y)?[o.compileAxis(h.Y,e)]:[]);a.length>0&&(t.axes=a)}var r=f.compileLegends(e);return r.length>0&&(t.legends=r),t}var r=e("./Model"),o=e("./axis"),l=e("./data"),u=e("./layout"),c=e("./facet"),f=e("./legend"),s=e("./mark/mark"),d=e("./scale"),p=e("./common"),m=e("../util"),g=e("../data"),h=e("../channel"),O=e("./Model");t.Model=O.Model,t.compile=i,t.compileRootGroup=a},{"../channel":10,"../data":31,"../util":42,"./Model":11,"./axis":12,"./common":13,"./data":16,"./facet":17,"./layout":18,"./legend":19,"./mark/mark":23,"./scale":27}],15:[function(e,n,t){function i(e,n,t,i){return u.extend(["filled","opacity","orient","align"].reduce(function(c,f){var s=t.mark[f];switch(f){case"filled":void 0===s&&(c[f]=e!==l.POINT&&e!==l.LINE);break;case"opacity":void 0===s&&u.contains([l.POINT,l.TICK,l.CIRCLE,l.SQUARE],e)&&(r.isAggregate(n)&&!r.has(n,a.DETAIL)||(c[f]=.7));break;case"orient":i&&(c[f]=i.groupbyChannel===a.Y?"horizontal":void 0),void 0===s&&(c[f]=o.isMeasure(n[a.X])&&!o.isMeasure(n[a.Y])?"horizontal":void 0);break;case"align":void 0===s&&(c[f]=r.has(n,a.X)?"center":"right")}return c},{}),t.mark)}var a=e("../channel"),r=e("../encoding"),o=e("../fielddef"),l=e("../mark"),u=e("../util");t.compileMarkConfig=i},{"../channel":10,"../encoding":32,"../fielddef":33,"../mark":35,"../util":42}],16:[function(e,n,t){function i(e){var n=[T.def(e)],t=E.def(e);t&&n.push(t),a(n[n.length-1],e),r(n[n.length-1],e);var i=e.stack();return i&&n.push(y.def(e,i)),n.concat(v.defs(e))}function a(e,n){n.has(f.COLOR)&&n.fieldDef(f.COLOR).type===p.ORDINAL&&(e.transform=e.transform.concat([{type:"sort",by:n.field(f.COLOR)},{type:"rank",field:n.field(f.COLOR),output:{rank:n.field(f.COLOR,{prefn:"rank_"})}}]))}function r(e,n){n.forEach(function(t,i){var a=n.scale(i);a&&a.type===u.ScaleType.LOG&&e.transform.push({type:"filter",test:n.field(i,{datum:!0})+" > 0"})})}var o=e("../fielddef"),l=e("../util"),u=e("../scale"),c=e("../bin"),f=e("../channel"),s=e("../data"),d=e("../fielddef"),p=e("../type"),m=e("./scale"),g=e("./time"),h=e("../aggregate"),O={nominal:!1,ordinal:!1,quantitative:!0,temporal:!0};t.compileData=i;var T;!function(e){function n(e){var n={name:s.SOURCE},a=e.data();if(a)if(a.values&&a.values.length>0)n.values=e.data().values,n.format={type:"json"};else if(a.url){n.url=a.url;var r=/(?:\.([^.]+))?$/.exec(n.url)[1];l.contains(["json","csv","tsv"],r)||(r="json"),n.format={type:e.data().formatType||r}}var o=t(e);return o&&(n.format=n.format||{},
n.format.parse=o),n.transform=i(e),n}function t(e){var n,t=(e.transform().calculate||[]).reduce(function(e,n){return e[n.field]=!0,e},{});return e.forEach(function(e){if(e.type===p.TEMPORAL)n=n||{},n[e.field]="date";else if(e.type===p.QUANTITATIVE){if(o.isCount(e)||t[e.field])return;n=n||{},n[e.field]="number"}}),n}function i(e){return h(e).concat(E(e),T(e),r(e),a(e))}function a(e){return e.reduce(function(e,n,t){var i=d.field(n,{nofn:!0,datum:!0});return n.type===p.TEMPORAL&&n.timeUnit&&e.push({type:"formula",field:d.field(n),expr:g.parseExpression(n.timeUnit,i)}),e},[])}function r(e){return e.reduce(function(n,t,i){var a=e.fieldDef(i).bin,r=e.scale(i);if(a){var o=l.extend({type:"bin",field:t.field,output:{start:d.field(t,{binSuffix:"_start"}),mid:d.field(t,{binSuffix:"_mid"}),end:d.field(t,{binSuffix:"_end"})}},"boolean"==typeof a?{}:a);o.maxbins||o.step||(o.maxbins=c.autoMaxBins(i)),n.push(o),m.scaleType(r,t,i,e.mark())!==u.ScaleType.ORDINAL&&i!==f.COLOR||n.push({type:"formula",field:d.field(t,{binSuffix:"_range"}),expr:d.field(t,{datum:!0,binSuffix:"_start"})+" + '-' + "+d.field(t,{datum:!0,binSuffix:"_end"})})}return n},[])}function h(e){var n=e.transform().filterNull,t=l.keys(e.reduce(function(e,t){return(n||void 0===n&&t.field&&"*"!==t.field&&O[t.type])&&(e[t.field]=!0),e},{}));return t.length>0?[{type:"filter",test:t.map(function(e){return"datum."+e+"!==null"}).join(" && ")}]:[]}function T(e){var n=e.transform().filter;return n?[{type:"filter",test:n}]:[]}function E(e){return(e.transform().calculate||[]).reduce(function(e,n){return e.push(l.extend({type:"formula"},n)),e},[])}e.def=n,e.transform=i,e.timeTransform=a,e.binTransform=r,e.nullFilterTransform=h,e.filterTransform=T,e.formulaTransform=E}(T=t.source||(t.source={}));var E;!function(e){function n(e){var n={},t={},i=!1;e.forEach(function(a,r){if(a.aggregate)i=!0,a.aggregate===h.AggregateOp.COUNT?(t["*"]=t["*"]||{},t["*"].count=!0):(t[a.field]=t[a.field]||{},t[a.field][a.aggregate]=!0);else if(a.bin){n[d.field(a,{binSuffix:"_start"})]=d.field(a,{binSuffix:"_start"}),n[d.field(a,{binSuffix:"_mid"})]=d.field(a,{binSuffix:"_mid"}),n[d.field(a,{binSuffix:"_end"})]=d.field(a,{binSuffix:"_end"});var o=e.scale(r);m.scaleType(o,a,r,e.mark())===u.ScaleType.ORDINAL&&(n[d.field(a,{binSuffix:"_range"})]=d.field(a,{binSuffix:"_range"}))}else n[d.field(a)]=d.field(a)});var a=l.vals(n),r=l.reduce(t,function(e,n,t){return e[t]=l.keys(n),e},{});return i?{name:s.SUMMARY,source:s.SOURCE,transform:[{type:"aggregate",groupby:a,summarize:r}]}:null}e.def=n}(E=t.summary||(t.summary={}));var y;!function(e){function n(e,n){var t=n.groupbyChannel,i=n.fieldChannel,a=(e.has(f.COLUMN)?[e.field(f.COLUMN)]:[]).concat(e.has(f.ROW)?[e.field(f.ROW)]:[]),r={name:s.STACKED_SCALE,source:e.dataTable(),transform:[{type:"aggregate",groupby:[e.field(t)].concat(a),summarize:[{ops:["sum"],field:e.field(i)}]}]};return r}e.def=n}(y=t.stack||(t.stack={}));var v;!function(e){function n(e){var n={};return e.reduce(function(e,t,i){if(t.timeUnit){var a=g.rawDomain(t.timeUnit,i);a&&!n[t.timeUnit]&&(n[t.timeUnit]=!0,e.push({name:t.timeUnit,values:a,transform:[{type:"formula",field:"date",expr:g.parseExpression(t.timeUnit,"datum.data",!0)}]}))}return e},[])}e.defs=n}(v=t.dates||(t.dates={})),t.rankTransform=a,t.filterNonPositiveForLog=r},{"../aggregate":7,"../bin":9,"../channel":10,"../data":31,"../fielddef":33,"../scale":36,"../type":41,"../util":42,"./scale":27,"./time":29}],17:[function(e,n,t){function i(e,n){var t=e.has(m.ROW),i=e.has(m.COLUMN);return e.has(m.ROW)&&!g.isDimension(e.encoding().row)&&d.error("Row encoding should be ordinal."),e.has(m.COLUMN)&&!g.isDimension(e.encoding().column)&&d.error("Col encoding should be ordinal."),{marks:[].concat(l(e),[r(e,n)]),scales:O.compileScales(e),axes:[].concat(t&&e.axis(m.ROW)?[h.compileAxis(m.ROW,e)]:[],i&&e.axis(m.COLUMN)?[h.compileAxis(m.COLUMN,e)]:[])}}function a(e){var n=[];return e.has(m.X)&&e.axis(m.X)&&h.gridShow(e,m.X)&&n.push(h.compileInnerAxis(m.X,e)),e.has(m.Y)&&e.axis(m.Y)&&h.gridShow(e,m.Y)&&n.push(h.compileInnerAxis(m.Y,e)),n}function r(e,n){var t=e.spec().name,i={name:(t?t+"-":"")+"cell",type:"group",from:{data:e.dataTable(),transform:[{type:"facet",groupby:[].concat(e.has(m.ROW)?[e.field(m.ROW)]:[],e.has(m.COLUMN)?[e.field(m.COLUMN)]:[])}]},properties:{update:o(e)},marks:n},r=a(e);return r.length>0&&(i.axes=r),i}function o(e){var n={x:e.has(m.COLUMN)?{scale:e.scaleName(m.COLUMN),field:e.field(m.COLUMN),offset:e.scale(m.COLUMN).padding/2}:{value:e.config().facet.scale.padding/2},y:e.has(m.ROW)?{scale:e.scaleName(m.ROW),field:e.field(m.ROW),offset:e.scale(m.ROW).padding/2}:{value:e.config().facet.scale.padding/2},width:{field:{parent:"cellWidth"}},height:{field:{parent:"cellHeight"}}};return T.applyConfig(n,e.config().cell,T.FILL_STROKE_CONFIG.concat(["clip"])),T.applyConfig(n,e.config().facet.cell,T.FILL_STROKE_CONFIG.concat(["clip"])),n}function l(e){var n=[];return e.has(m.X)?e.axis(m.X)&&n.push(u(e)):e.has(m.ROW)&&n.push.apply(n,f(e)),e.has(m.Y)?e.axis(m.Y)&&n.push(c(e)):e.has(m.COLUMN)&&n.push.apply(n,s(e)),n}function u(e){var n=e.has(m.COLUMN),t=e.spec().name;return p.extend({name:(t?t+"-":"")+"x-axes",type:"group"},n?{from:{data:e.dataTable(),transform:[{type:"aggregate",groupby:[e.field(m.COLUMN)],summarize:{"*":["count"]}}]}}:{},{properties:{update:{width:{field:{parent:"cellWidth"}},height:{field:{group:"height"}},x:n?{scale:e.scaleName(m.COLUMN),field:e.field(m.COLUMN),offset:e.scale(m.COLUMN).padding/2}:{value:e.config().facet.scale.padding/2}}}},e.axis(m.X)?{axes:[h.compileAxis(m.X,e)]}:{})}function c(e){var n=e.has(m.ROW),t=e.spec().name;return p.extend({name:(t?t+"-":"")+"y-axes",type:"group"},n?{from:{data:e.dataTable(),transform:[{type:"aggregate",groupby:[e.field(m.ROW)],summarize:{"*":["count"]}}]}}:{},{properties:{update:{width:{field:{group:"width"}},height:{field:{parent:"cellHeight"}},y:n?{scale:e.scaleName(m.ROW),field:e.field(m.ROW),offset:e.scale(m.ROW).padding/2}:{value:e.config().facet.scale.padding/2}}}},e.axis(m.Y)?{axes:[h.compileAxis(m.Y,e)]}:{})}function f(e){var n=e.spec().name,t=e.config().facet.grid,i={name:(n?n+"-":"")+"row-grid",type:"rule",from:{data:e.dataTable(),transform:[{type:"facet",groupby:[e.field(m.ROW)]}]},properties:{update:{y:{scale:e.scaleName(m.ROW),field:e.field(m.ROW)},x:{value:0,offset:-t.offset},x2:{field:{group:"width"},offset:t.offset},stroke:{value:t.color},strokeOpacity:{value:t.opacity},strokeWidth:{value:.5}}}};return[i,{name:(n?n+"-":"")+"row-grid-end",type:"rule",properties:{update:{y:{field:{group:"height"}},x:{value:0,offset:-t.offset},x2:{field:{group:"width"},offset:t.offset},stroke:{value:t.color},strokeOpacity:{value:t.opacity},strokeWidth:{value:.5}}}}]}function s(e){var n=e.spec().name,t=e.config().facet.grid,i={name:(n?n+"-":"")+"column-grid",type:"rule",from:{data:e.dataTable(),transform:[{type:"facet",groupby:[e.field(m.COLUMN)]}]},properties:{update:{x:{scale:e.scaleName(m.COLUMN),field:e.field(m.COLUMN)},y:{value:0,offset:-t.offset},y2:{field:{group:"height"},offset:t.offset},stroke:{value:t.color},strokeOpacity:{value:t.opacity},strokeWidth:{value:.5}}}};return[i,{name:(n?n+"-":"")+"column-grid-end",type:"rule",properties:{update:{x:{field:{group:"width"}},y:{value:0,offset:-t.offset},y2:{field:{group:"height"},offset:t.offset},stroke:{value:t.color},strokeOpacity:{value:t.opacity},strokeWidth:{value:.5}}}}]}var d=e("../util"),p=e("../util"),m=e("../channel"),g=e("../fielddef"),h=e("./axis"),O=e("./scale"),T=e("./common");t.facetMixins=i},{"../channel":10,"../fielddef":33,"../util":42,"./axis":12,"./common":13,"./scale":27}],18:[function(e,n,t){function i(e){var n=[l.X,l.Y,l.ROW,l.COLUMN].reduce(function(n,t){if(e.has(t)&&e.isOrdinalScale(t)){var i=e.scale(t);i.domain instanceof Array||n.push({field:e.field(t),ops:["distinct"]})}return n},[]),t=r(e,l.X,e.cellWidth()),i=r(e,l.Y,e.cellHeight()),a=e.has(l.COLUMN)||e.has(l.ROW),c=[{type:"formula",field:"cellWidth",expr:t},{type:"formula",field:"cellHeight",expr:i},{type:"formula",field:"width",expr:a?o(e,l.COLUMN,"datum.cellWidth"):t},{type:"formula",field:"height",expr:a?o(e,l.ROW,"datum.cellHeight"):i}];return n.length>0?{name:u.LAYOUT,source:e.dataTable(),transform:[].concat([{type:"aggregate",summarize:n}],c)}:{name:u.LAYOUT,values:[{}],transform:c}}function a(e,n){var t=e.scale(n);if(t.domain instanceof Array)return t.domain.length;var i=e.fieldDef(n).timeUnit,a=i?f.rawDomain(i,n):null;return null!==a?a.length:e.field(n,{datum:!0,prefn:"distinct_"})}function r(e,n,t){if(e.has(n)){if(e.isOrdinalScale(n)){var i=e.scale(n);return"("+a(e,n)+" + "+i.padding+") * "+i.bandSize}return t+""}return e.mark()===c.TEXT&&n===l.X?e.config().scale.textBandWidth+"":e.config().scale.bandSize+""}function o(e,n,t){var i=e.scale(n);if(e.has(n)){var a=i.domain instanceof Array?i.domain.length:e.field(n,{datum:!0,prefn:"distinct_"});return"("+t+" + "+i.padding+") * "+a}return t+" + "+e.config().facet.scale.padding}var l=e("../channel"),u=e("../data"),c=e("../mark"),f=e("./time");t.compileLayoutData=i},{"../channel":10,"../data":31,"../mark":35,"./time":29}],19:[function(e,n,t){function i(e){var n=[];if(e.has(u.COLOR)&&e.legend(u.COLOR)){var t=e.fieldDef(u.COLOR),i=e.scaleName(l(t)?m.COLOR_LEGEND:u.COLOR),r=e.config().mark.filled?{fill:i}:{stroke:i};n.push(a(e,u.COLOR,r))}return e.has(u.SIZE)&&e.legend(u.SIZE)&&n.push(a(e,u.SIZE,{size:e.scaleName(u.SIZE)})),e.has(u.SHAPE)&&e.legend(u.SHAPE)&&n.push(a(e,u.SHAPE,{shape:e.scaleName(u.SHAPE)})),n}function a(e,n,t){var i=e.fieldDef(n),a=e.legend(n);t.title=r(a,i),s.extend(t,o(a,e,n)),["orient","values"].forEach(function(e){var n=a[e];void 0!==n&&(t[e]=n)});var l="boolean"!=typeof a&&a.properties||{};return["title","symbols","legend","labels"].forEach(function(a){var r=g[a]?g[a](i,l[a],e,n):l[a];void 0!==r&&(t.properties=t.properties||{},t.properties[a]=r)}),t}function r(e,n){return"boolean"!=typeof e&&e.title?e.title:c.title(n)}function o(e,n,t){var i=n.fieldDef(t);return i.bin?{}:d.formatMixins(n,t,"boolean"!=typeof e?e.format:void 0)}function l(e){return e.type===p.ORDINAL||e.bin||e.timeUnit}var u=e("../channel"),c=e("../fielddef"),f=e("../mark"),s=e("../util"),d=e("./common"),p=e("../type"),m=e("./scale");t.compileLegends=i,t.compileLegend=a,t.title=r,t.formatMixins=o,t.useColorLegendScale=l;var g;!function(e){function n(e,n,t,i){var a={},r=t.mark();switch(r){case f.BAR:case f.TICK:case f.TEXT:a.shape={value:"square"};break;case f.CIRCLE:case f.SQUARE:a.shape={value:r};break;case f.POINT:case f.LINE:case f.AREA:}var o=t.config().mark.filled;d.applyMarkConfig(a,t,s.without(d.FILL_STROKE_CONFIG,[o?"fill":"stroke"])),o&&(a.strokeWidth={value:0});var c;return t.has(u.COLOR)&&i===u.COLOR?l(e)&&(c={scale:t.scaleName(u.COLOR),field:"data"}):t.fieldDef(u.COLOR).value&&(c={value:t.fieldDef(u.COLOR).value}),void 0!==c?o?a.fill=c:a.stroke=c:i!==u.COLOR&&(a[o?"fill":"stroke"]=a[o?"fill":"stroke"]||{value:t.config().mark.color}),a=s.extend(a,n||{}),s.keys(a).length>0?a:void 0}function t(e,n,t,i){if(i===u.COLOR){if(e.type===p.ORDINAL)return{text:{scale:t.scaleName(m.COLOR_LEGEND),field:"data"}};if(e.bin)return{text:{scale:t.scaleName(m.COLOR_LEGEND_LABEL),field:"data"}};if(e.timeUnit)return{text:{template:"{{ datum.data | time:'"+d.timeFormat(t,i)+"'}}"}}}}e.symbols=n,e.labels=t}(g||(g={}))},{"../channel":10,"../fielddef":33,"../mark":35,"../type":41,"../util":42,"./common":13,"./scale":27}],20:[function(e,n,t){var i,a=e("../../channel"),r=e("../../fielddef"),o=e("../common");!function(e){function n(){return"area"}function t(e){var n={},t=e.config().mark.orient;void 0!==t&&(n.orient={value:t});var i=e.stack(),l=e.encoding().x;i&&a.X===i.fieldChannel?n.x={scale:e.scaleName(a.X),field:e.field(a.X,{suffix:"_start"})}:r.isMeasure(l)?n.x={scale:e.scaleName(a.X),field:e.field(a.X)}:r.isDimension(l)&&(n.x={scale:e.scaleName(a.X),field:e.field(a.X,{binSuffix:"_mid"})}),"horizontal"===t&&(i&&a.X===i.fieldChannel?n.x2={scale:e.scaleName(a.X),field:e.field(a.X,{suffix:"_end"})}:n.x2={scale:e.scaleName(a.X),value:0});var u=e.encoding().y;return i&&a.Y===i.fieldChannel?n.y={scale:e.scaleName(a.Y),field:e.field(a.Y,{suffix:"_start"})}:r.isMeasure(u)?n.y={scale:e.scaleName(a.Y),field:e.field(a.Y)}:r.isDimension(u)&&(n.y={scale:e.scaleName(a.Y),field:e.field(a.Y,{binSuffix:"_mid"})}),"horizontal"!==t&&(i&&a.Y===i.fieldChannel?n.y2={scale:e.scaleName(a.Y),field:e.field(a.Y,{suffix:"_end"})}:n.y2={scale:e.scaleName(a.Y),value:0}),o.applyColorAndOpacity(n,e),o.applyMarkConfig(n,e,["interpolate","tension"]),n}function i(e){}e.markType=n,e.properties=t,e.labels=i}(i=t.area||(t.area={}))},{"../../channel":10,"../../fielddef":33,"../common":13}],21:[function(e,n,t){var i,a=e("../../channel"),r=e("../../fielddef"),o=e("../common");!function(e){function n(){return"rect"}function t(e){var n={},t=e.config().mark.orient,l=e.stack(),u=e.encoding().x;l&&a.X===l.fieldChannel?(n.x={scale:e.scaleName(a.X),field:e.field(a.X,{suffix:"_start"})},n.x2={scale:e.scaleName(a.X),field:e.field(a.X,{suffix:"_end"})}):r.isMeasure(u)?"horizontal"===t?(n.x={scale:e.scaleName(a.X),field:e.field(a.X)},n.x2={scale:e.scaleName(a.X),value:0}):(n.xc={scale:e.scaleName(a.X),field:e.field(a.X)},n.width={value:i(e,a.X)}):e.fieldDef(a.X).bin?e.has(a.SIZE)&&"horizontal"!==t?(n.xc={scale:e.scaleName(a.X),field:e.field(a.X,{binSuffix:"_mid"})},n.width={scale:e.scaleName(a.SIZE),field:e.field(a.SIZE)}):(n.x={scale:e.scaleName(a.X),field:e.field(a.X,{binSuffix:"_start"}),offset:1},n.x2={scale:e.scaleName(a.X),field:e.field(a.X,{binSuffix:"_end"})}):(e.has(a.X)?n.xc={scale:e.scaleName(a.X),field:e.field(a.X)}:n.x={value:0,offset:2},n.width=e.has(a.SIZE)&&"horizontal"!==t?{scale:e.scaleName(a.SIZE),field:e.field(a.SIZE)}:{value:i(e,a.X)});var c=e.encoding().y;return l&&a.Y===l.fieldChannel?(n.y={scale:e.scaleName(a.Y),field:e.field(a.Y,{suffix:"_start"})},n.y2={scale:e.scaleName(a.Y),field:e.field(a.Y,{suffix:"_end"})}):r.isMeasure(c)?"horizontal"!==t?(n.y={scale:e.scaleName(a.Y),field:e.field(a.Y)},n.y2={scale:e.scaleName(a.Y),value:0}):(n.yc={scale:e.scaleName(a.Y),field:e.field(a.Y)},n.height={value:i(e,a.Y)}):e.fieldDef(a.Y).bin?e.has(a.SIZE)&&"horizontal"===t?(n.yc={scale:e.scaleName(a.Y),field:e.field(a.Y,{binSuffix:"_mid"})},n.height={scale:e.scaleName(a.SIZE),field:e.field(a.SIZE)}):(n.y={scale:e.scaleName(a.Y),field:e.field(a.Y,{binSuffix:"_start"})},n.y2={scale:e.scaleName(a.Y),field:e.field(a.Y,{binSuffix:"_end"}),offset:1}):(e.has(a.Y)?n.yc={scale:e.scaleName(a.Y),field:e.field(a.Y)}:n.y2={field:{group:"height"},offset:-1},n.height=e.has(a.SIZE)&&"horizontal"===t?{scale:e.scaleName(a.SIZE),field:e.field(a.SIZE)}:{value:i(e,a.Y)}),o.applyColorAndOpacity(n,e),n}function i(e,n){var t=e.fieldDef(a.SIZE);if(t&&void 0!==t.value)return t.value;var i=e.config().mark;return i.barSize?i.barSize:e.isOrdinalScale(n)?e.scale(n).bandSize-1:e.has(n)?i.barThinSize:e.config().scale.bandSize-1}function l(e){}e.markType=n,e.properties=t,e.labels=l}(i=t.bar||(t.bar={}))},{"../../channel":10,"../../fielddef":33,"../common":13}],22:[function(e,n,t){var i,a=e("../../channel"),r=e("../common");!function(e){function n(){return"line"}function t(e){var n={};return e.has(a.X)?n.x={scale:e.scaleName(a.X),field:e.field(a.X,{binSuffix:"_mid"})}:n.x={value:0},e.has(a.Y)?n.y={scale:e.scaleName(a.Y),field:e.field(a.Y,{binSuffix:"_mid"})}:n.y={field:{group:"height"}},r.applyColorAndOpacity(n,e),r.applyMarkConfig(n,e,["interpolate","tension"]),n}function i(e){}e.markType=n,e.properties=t,e.labels=i}(i=t.line||(t.line={}))},{"../../channel":10,"../common":13}],23:[function(e,n,t){function i(e){return d.contains([f.LINE,f.AREA],e.mark())?a(e):r(e)}function a(e){var n=e.mark(),t=e.spec().name,i=e.has(c.ROW)||e.has(c.COLUMN),a={data:e.dataTable()},r=u(e),p=[d.extend(t?{name:t+"-marks"}:{},{type:y[n].markType(),from:d.extend(i||r.length>0?{}:a,{transform:[{type:"sort",by:l(e)}]}),properties:{update:y[n].properties(e)}})];if(r.length>0){var m={type:"facet",groupby:r},g=n===f.AREA&&e.stack()?[s.imputeTransform(e),s.stackTransform(e),m]:[].concat(m,e.has(c.ORDER)?[{type:"sort",by:o(e)}]:[]);return[{name:(t?t+"-":"")+n+"-facet",type:"group",from:d.extend(i?{}:a,{transform:g}),properties:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:p}]}return p}function r(e){var n=e.mark(),t=e.spec().name,i=e.has(c.ROW)||e.has(c.COLUMN),a={data:e.dataTable()},r=[];if(n===f.TEXT&&e.has(c.COLOR)&&e.config().mark.applyColorToBackground&&!e.has(c.X)&&!e.has(c.Y)&&r.push(d.extend(t?{name:t+"-background"}:{},{type:"rect"},i?{}:{from:a},{properties:{update:O.text.background(e)}})),r.push(d.extend(t?{name:t+"-marks"}:{},{type:y[n].markType()},!i||e.stack()||e.has(c.ORDER)?{from:d.extend(i?{}:a,e.stack()?{transform:[s.stackTransform(e)]}:e.has(c.ORDER)?{transform:[{type:"sort",by:o(e)}]}:{})}:{},{properties:{update:y[n].properties(e)}})),e.has(c.LABEL)&&y[n].labels){var l=y[n].labels(e);void 0!==l&&r.push(d.extend(t?{name:t+"-label"}:{},{type:"text"},i?{}:{from:a},{properties:{update:l}}))}return r}function o(e){if(e.has(c.ORDER)){var n=e.encoding().order;return n instanceof Array?n.map(E.sortField):E.sortField(n)}return null}function l(e){if(e.mark()===f.LINE&&e.has(c.PATH)){var n=e.encoding().path;return n instanceof Array?n.map(E.sortField):E.sortField(n)}return"-"+e.field("horizontal"===e.config().mark.orient?c.Y:c.X)}function u(e){return[c.COLOR,c.DETAIL,c.SHAPE].reduce(function(n,t){return e.has(t)&&!e.fieldDef(t).aggregate&&n.push(e.field(t)),n},[])}var c=e("../../channel"),f=e("../../mark"),s=e("../stack"),d=e("../../util"),p=e("./area"),m=e("./bar"),g=e("./line"),h=e("./point"),O=e("./text"),T=e("./tick"),E=e("../common"),y={area:p.area,bar:m.bar,line:g.line,point:h.point,text:O.text,tick:T.tick,circle:h.circle,square:h.square};t.compileMark=i},{"../../channel":10,"../../mark":35,"../../util":42,"../common":13,"../stack":28,"./area":20,"./bar":21,"./line":22,"./point":24,"./text":25,"./tick":26}],24:[function(e,n,t){var i,a=e("../../channel"),r=e("../common");!function(e){function n(){return"symbol"}function t(e,n){var t={};return e.has(a.X)?t.x={scale:e.scaleName(a.X),field:e.field(a.X,{binSuffix:"_mid"})}:t.x={value:e.config().scale.bandSize/2},e.has(a.Y)?t.y={scale:e.scaleName(a.Y),field:e.field(a.Y,{binSuffix:"_mid"})}:t.y={value:e.config().scale.bandSize/2},e.has(a.SIZE)?t.size={scale:e.scaleName(a.SIZE),field:e.field(a.SIZE)}:t.size={value:i(e)},n?t.shape={value:n}:e.has(a.SHAPE)?t.shape={scale:e.scaleName(a.SHAPE),field:e.field(a.SHAPE)}:e.fieldDef(a.SHAPE).value?t.shape={value:e.fieldDef(a.SHAPE).value}:e.config().mark.shape&&(t.shape={value:e.config().mark.shape}),r.applyColorAndOpacity(t,e),t}function i(e){var n=e.fieldDef(a.SIZE);return n&&void 0!==n.value?n.value:e.config().mark.size}function o(e){}e.markType=n,e.properties=t,e.labels=o}(i=t.point||(t.point={}));var o;!function(e){function n(){return"symbol"}function t(e){return i.properties(e,"circle")}function a(e){}e.markType=n,e.properties=t,e.labels=a}(o=t.circle||(t.circle={}));var l;!function(e){function n(){return"symbol"}function t(e){return i.properties(e,"square")}function a(e){}e.markType=n,e.properties=t,e.labels=a}(l=t.square||(t.square={}))},{"../../channel":10,"../common":13}],25:[function(e,n,t){var i,a=e("../../channel"),r=e("../common"),o=e("../../util"),l=e("../../type");!function(e){function n(){return"text"}function t(e){return{x:{value:0},y:{value:0},width:{field:{group:"width"}},height:{field:{group:"height"}},fill:{scale:e.scaleName(a.COLOR),field:e.field(a.COLOR,e.fieldDef(a.COLOR).type===l.ORDINAL?{prefn:"rank_"}:{})}}}function i(e){var n={};r.applyMarkConfig(n,e,["angle","align","baseline","dx","dy","font","fontWeight","fontStyle","radius","theta","text"]);var t=e.fieldDef(a.TEXT);if(e.has(a.X)?n.x={scale:e.scaleName(a.X),field:e.field(a.X,{binSuffix:"_mid"})}:e.has(a.TEXT)&&e.fieldDef(a.TEXT).type===l.QUANTITATIVE?n.x={field:{group:"width"},offset:-5}:n.x={value:e.config().scale.textBandWidth/2},e.has(a.Y)?n.y={scale:e.scaleName(a.Y),field:e.field(a.Y,{binSuffix:"_mid"})}:n.y={value:e.config().scale.bandSize/2},e.has(a.SIZE)?n.fontSize={scale:e.scaleName(a.SIZE),field:e.field(a.SIZE)}:n.fontSize={value:u(e)},!e.config().mark.applyColorToBackground||e.has(a.X)||e.has(a.Y))r.applyColorAndOpacity(n,e);else{n.fill={value:"black"};var i=e.config().mark.opacity;i&&(n.opacity={value:i})}if(e.has(a.TEXT))if(o.contains([l.QUANTITATIVE,l.TEMPORAL],e.fieldDef(a.TEXT).type)){var c=e.config().mark.format;o.extend(n,r.formatMixins(e,a.TEXT,c))}else n.text={field:e.field(a.TEXT)};else t.value&&(n.text={value:t.value});return n}function u(e){var n=e.fieldDef(a.SIZE);return n&&void 0!==n.value?n.value:e.config().mark.fontSize}e.markType=n,e.background=t,e.properties=i}(i=t.text||(t.text={}))},{"../../channel":10,"../../type":41,"../../util":42,"../common":13}],26:[function(e,n,t){var i,a=e("../../channel"),r=e("../common");!function(e){function n(){return"rect"}function t(e){var n={};return e.has(a.X)?n.xc={scale:e.scaleName(a.X),field:e.field(a.X,{binSuffix:"_mid"})}:n.xc={value:e.config().scale.bandSize/2},e.has(a.Y)?n.yc={scale:e.scaleName(a.Y),field:e.field(a.Y,{binSuffix:"_mid"})}:n.yc={value:e.config().scale.bandSize/2},"horizontal"===e.config().mark.orient?(n.width={value:e.config().mark.tickThickness},n.height=e.has(a.SIZE)?{scale:e.scaleName(a.SIZE),field:e.field(a.SIZE)}:{value:i(e,a.Y)}):(n.width=e.has(a.SIZE)?{scale:e.scaleName(a.SIZE),field:e.field(a.SIZE)}:{value:i(e,a.X)},n.height={value:e.config().mark.tickThickness}),r.applyColorAndOpacity(n,e),n}function i(e,n){var t=e.fieldDef(a.SIZE);if(t&&void 0!==t.value)return t.value;var i=e.config().scale,r=e.config().mark;if(r.tickSize)return r.tickSize;var o=e.has(n)?e.scale(n).bandSize:i.bandSize;return o/1.5}function o(e){}e.markType=n,e.properties=t,e.labels=o}(i=t.tick||(t.tick={}))},{"../../channel":10,"../common":13}],27:[function(e,n,t){function i(e){return e.channelWithScales().reduce(function(n,t){var i=e.fieldDef(t);return t===v.COLOR&&e.legend(v.COLOR)&&(i.type===A.ORDINAL||i.bin||i.timeUnit)&&(n.push(r(e,i)),i.bin&&n.push(o(e,i))),n.push(a(e,i,t)),n},[])}function a(e,n,i){var a=e.scale(i),r=e.sort(i),o={name:e.scaleName(i),type:l(a,n,i,e.mark())};return o.domain=u(a,e,i,o.type),E.extend(o,s(a,e,i,o.type)),r&&"descending"===("string"==typeof r?r:r.order)&&(o.reverse=!0),["round","clamp","nice","exponent","zero","padding","points"].forEach(function(e){var r=t[e](a[e],o.type,i,n);void 0!==r&&(o[e]=r)}),o}function r(e,n){return{name:e.scaleName(t.COLOR_LEGEND),type:"ordinal",domain:{data:e.dataTable(),field:e.field(v.COLOR,n.bin||n.timeUnit?{}:{prefn:"rank_"}),sort:!0},range:{data:e.dataTable(),field:e.field(v.COLOR),sort:!0}}}function o(e,n){return{name:e.scaleName(t.COLOR_LEGEND_LABEL),type:"ordinal",domain:{data:e.dataTable(),field:e.field(v.COLOR,{prefn:"rank_"}),sort:!0},range:{data:e.dataTable(),field:x.field(n,{binSuffix:"_range"}),sort:{field:e.field(v.COLOR,{binSuffix:"_start"}),op:"min"}}}}function l(e,n,t,i){if(!v.hasScale(t))return null;if(E.contains([v.ROW,v.COLUMN,v.SHAPE],t))return M.ScaleType.ORDINAL;if(void 0!==e.type)return e.type;switch(n.type){case A.NOMINAL:return M.ScaleType.ORDINAL;case A.ORDINAL:return t===v.COLOR?M.ScaleType.LINEAR:M.ScaleType.ORDINAL;case A.TEMPORAL:if(t===v.COLOR)return M.ScaleType.TIME;if(n.timeUnit)switch(n.timeUnit){case L.TimeUnit.HOURS:case L.TimeUnit.DAY:case L.TimeUnit.MONTH:return M.ScaleType.ORDINAL;default:return M.ScaleType.TIME}return M.ScaleType.TIME;case A.QUANTITATIVE:return n.bin?E.contains([v.X,v.Y,v.COLOR],t)?M.ScaleType.LINEAR:M.ScaleType.ORDINAL:M.ScaleType.LINEAR}return null}function u(e,n,t,i){var a=n.fieldDef(t);if(e.domain)return e.domain;if(a.type===A.TEMPORAL)return R.rawDomain(a.timeUnit,t)?{data:a.timeUnit,field:"date"}:{data:n.dataTable(),field:n.field(t),sort:{field:n.field(t),op:"min"}};var r=n.stack();if(r&&t===r.fieldChannel)return r.offset===C.StackOffset.NORMALIZE?[0,1]:{data:S.STACKED_SCALE,field:n.field(t,{prefn:"sum_"})};var o=f(e,n,t,i),l=c(n,t,i);return o?{data:S.SOURCE,field:n.field(t,{noAggregate:!0})}:a.bin?i===M.ScaleType.ORDINAL?{data:n.dataTable(),field:n.field(t,{binSuffix:"_range"}),sort:{field:n.field(t,{binSuffix:"_start"}),op:"min"}}:t===v.COLOR?{data:n.dataTable(),field:n.field(t,{binSuffix:"_start"})}:{data:n.dataTable(),field:[n.field(t,{binSuffix:"_start"}),n.field(t,{binSuffix:"_end"})]}:l?{data:l.op?S.SOURCE:n.dataTable(),field:a.type===A.ORDINAL&&t===v.COLOR?n.field(t,{prefn:"rank_"}):n.field(t),sort:l}:{data:n.dataTable(),field:a.type===A.ORDINAL&&t===v.COLOR?n.field(t,{prefn:"rank_"}):n.field(t)}}function c(e,n,t){if(t===M.ScaleType.ORDINAL){var i=e.sort(n);return E.contains(["ascending","descending",void 0],i)?!0:"string"!=typeof i?{op:i.op,field:i.field}:void 0}}function f(e,n,t,i){var a=n.fieldDef(t);return e.includeRawDomain&&a.aggregate&&y.SHARED_DOMAIN_OPS.indexOf(a.aggregate)>=0&&(a.type===A.QUANTITATIVE&&!a.bin||a.type===A.TEMPORAL&&E.contains([M.ScaleType.TIME,M.ScaleType.UTC],i))}function s(e,n,t,i){var a=n.fieldDef(t),r=n.config().scale;if(i===M.ScaleType.ORDINAL&&e.bandSize&&E.contains([v.X,v.Y],t))return{bandSize:e.bandSize};if(e.range&&!E.contains([v.X,v.Y,v.ROW,v.COLUMN],t))return{range:e.range};switch(t){case v.X:return{rangeMin:0,rangeMax:n.cellWidth()};case v.Y:return{rangeMin:n.cellHeight(),rangeMax:0};case v.SIZE:if(n.mark()===N.BAR){if(void 0!==r.barSizeRange)return{range:r.barSizeRange};var o="horizontal"===n.config().mark.orient?v.Y:v.X;return{range:[n.config().mark.barThinSize,n.scale(o).bandSize]}}if(n.mark()===N.TEXT)return{range:r.fontSizeRange};if(void 0!==r.pointSizeRange)return{range:r.pointSizeRange};var l=x.isMeasure(n.encoding().x),u=x.isMeasure(n.encoding().y),c=l!==u?n.scale(l?v.Y:v.X).bandSize:Math.min(n.scale(v.X).bandSize||r.bandSize,n.scale(v.Y).bandSize||r.bandSize);return{range:[9,(c-2)*(c-2)]};case v.SHAPE:return{range:r.shapeRange};case v.COLOR:return a.type===A.NOMINAL?{range:r.nominalColorRange}:{range:r.sequentialColorRange};case v.ROW:return{range:"height"};case v.COLUMN:return{range:"width"}}return{}}function d(e,n){return E.contains([M.ScaleType.LINEAR,M.ScaleType.POW,M.ScaleType.SQRT,M.ScaleType.LOG,M.ScaleType.TIME,M.ScaleType.UTC],n)?e:void 0}function p(e,n){return n===M.ScaleType.POW?e:void 0}function m(e,n,t,i){return E.contains([M.ScaleType.LINEAR,M.ScaleType.POW,M.ScaleType.SQRT,M.ScaleType.LOG,M.ScaleType.TIME,M.ScaleType.UTC,M.ScaleType.QUANTIZE],n)?void 0!==e?e:E.contains([M.ScaleType.TIME,M.ScaleType.UTC],n)?R.smallestUnit(i.timeUnit):E.contains([v.X,v.Y],t):void 0}function g(e,n,t){return n===M.ScaleType.ORDINAL&&E.contains([v.X,v.Y],t)?e:void 0}function h(e,n,t){return n===M.ScaleType.ORDINAL&&E.contains([v.X,v.Y],t)?!0:void 0}function O(e,n,t){return E.contains([v.X,v.Y,v.ROW,v.COLUMN,v.SIZE],t)&&void 0!==e?e:void 0}function T(e,n,t,i){return E.contains([M.ScaleType.TIME,M.ScaleType.UTC,M.ScaleType.ORDINAL],n)?void 0:void 0!==e?e:!i.bin&&E.contains([v.X,v.Y],t)}var E=e("../util"),y=e("../aggregate"),v=e("../channel"),S=e("../data"),A=e("../type"),N=e("../mark"),R=e("./time"),M=e("../scale"),C=e("../config"),L=e("../timeunit"),x=e("../fielddef");t.COLOR_LEGEND="color_legend",t.COLOR_LEGEND_LABEL="color_legend_label",t.compileScales=i,t.scaleType=l,t.domain=u,t.domainSort=c,t.rangeMixins=s,t.clamp=d,t.exponent=p,t.nice=m,t.padding=g,t.points=h,t.round=O,t.zero=T},{"../aggregate":7,"../channel":10,"../config":30,"../data":31,"../fielddef":33,"../mark":35,"../scale":36,"../timeunit":40,"../type":41,"../util":42,"./time":29}],28:[function(e,n,t){function i(e,n,t,i){var r=a(e,n,t);if(r.length>0&&p.contains([f.BAR,f.AREA],e)&&i.mark.stacked!==c.StackOffset.NONE&&d.isAggregate(n)){var o=d.has(n,l.X)&&s.isMeasure(n.x),u=d.has(n,l.Y)&&s.isMeasure(n.y);if(o&&!u)return{groupbyChannel:l.Y,fieldChannel:l.X,stackFields:r,offset:i.mark.stacked};if(u&&!o)return{groupbyChannel:l.X,fieldChannel:l.Y,stackFields:r,offset:i.mark.stacked}}return null}function a(e,n,t){return[l.COLOR,l.DETAIL].reduce(function(i,a){var r=n[a];if(d.has(n,a))if(p.isArray(r))r.forEach(function(e){i.push(s.field(e))});else{var o=r;i.push(s.field(o,{binSuffix:g.scaleType(t[a],o,a,e)===u.ScaleType.ORDINAL?"_range":"_start"}))}return i},[])}function r(e){var n=e.stack();return{type:"impute",field:e.field(n.fieldChannel),groupby:n.stackFields,orderby:[e.field(n.groupbyChannel)],method:"value",value:0}}function o(e){var n=e.stack(),t=e.encoding(),i=e.has(l.ORDER)?(p.isArray(t[l.ORDER])?t[l.ORDER]:[t[l.ORDER]]).map(m.sortField):n.stackFields.map(function(e){return"-"+e}),a=e.field(n.fieldChannel),r={type:"stack",groupby:[e.field(n.groupbyChannel)],field:e.field(n.fieldChannel),sortby:i,output:{start:a+"_start",end:a+"_end"}};return n.offset&&(r.offset=n.offset),r}var l=e("../channel"),u=e("../scale"),c=e("../config"),f=e("../mark"),s=e("../fielddef"),d=e("../encoding"),p=e("../util"),m=e("./common"),g=e("./scale");t.compileStackProperties=i,t.imputeTransform=r,t.stackTransform=o},{"../channel":10,"../config":30,"../encoding":32,"../fielddef":33,"../mark":35,"../scale":36,"../util":42,"./common":13,"./scale":27}],29:[function(e,n,t){function i(e,n){if(void 0===n&&(n=!1),e){var t=e.toString(),i=[];t.indexOf("year")>-1&&i.push(n?"%y":"%Y"),t.indexOf("month")>-1&&i.push(n?"%b":"%B"),t.indexOf("day")>-1?i.push(n?"%a":"%A"):t.indexOf("date")>-1&&i.push("%d");var a=[];t.indexOf("hours")>-1&&a.push("%H"),t.indexOf("minutes")>-1&&a.push("%M"),t.indexOf("seconds")>-1&&a.push("%S"),t.indexOf("milliseconds")>-1&&a.push("%L");var r=[];return i.length>0&&r.push(i.join("-")),a.length>0&&r.push(a.join(":")),r.length>0?r.join(" "):void 0}}function a(e){return e?e.indexOf("second")>-1?"second":e.indexOf("minute")>-1?"minute":e.indexOf("hour")>-1?"hour":e.indexOf("day")>-1||e.indexOf("date")>-1?"day":e.indexOf("month")>-1?"month":e.indexOf("year")>-1?"year":void 0:void 0}function r(e,n,t){function i(e,i){return void 0===i&&(i=!0),t?n+(i?", ":""):e+"("+n+")"+(i?", ":"")}void 0===t&&(t=!1);var a="datetime(",r=e.toString();return a+=r.indexOf("year")>-1?i("year"):"2006, ",a+=r.indexOf("month")>-1?i("month"):"0, ",a+=r.indexOf("day")>-1?i("day",!1)+"+1, ":r.indexOf("date")>-1?i("date"):"1, ",a+=r.indexOf("hours")>-1?i("hours"):"0, ",a+=r.indexOf("minutes")>-1?i("minutes"):"0, ",a+=r.indexOf("seconds")>-1?i("seconds"):"0, ",a+=r.indexOf("milliseconds")>-1?i("milliseconds",!1):"0",a+")"}function o(e,n){if(l.contains([u.ROW,u.COLUMN,u.SHAPE,u.COLOR],n))return null;switch(e){case c.TimeUnit.SECONDS:return l.range(0,60);case c.TimeUnit.MINUTES:return l.range(0,60);case c.TimeUnit.HOURS:return l.range(0,24);case c.TimeUnit.DAY:return l.range(0,7);case c.TimeUnit.DATE:return l.range(1,32);case c.TimeUnit.MONTH:return l.range(0,12)}return null}var l=e("../util"),u=e("../channel"),c=e("../timeunit");t.format=i,t.smallestUnit=a,t.parseExpression=r,t.rawDomain=o},{"../channel":10,"../timeunit":40,"../util":42}],30:[function(e,n,t){var i=e("./scale"),a=e("./axis"),r=e("./legend");t.defaultCellConfig={width:200,height:200},t.defaultFacetCellConfig={stroke:"#ccc",strokeWidth:1};var o={color:"#000000",opacity:.4,offset:0};t.defaultFacetConfig={scale:i.defaultFacetScaleConfig,axis:a.defaultFacetAxisConfig,grid:o,cell:t.defaultFacetCellConfig},function(e){e[e.NORMAL="normal"]="NORMAL",e[e.BOLD="bold"]="BOLD"}(t.FontWeight||(t.FontWeight={}));t.FontWeight;!function(e){e[e.CIRCLE="circle"]="CIRCLE",e[e.SQUARE="square"]="SQUARE",e[e.CROSS="cross"]="CROSS",e[e.DIAMOND="diamond"]="DIAMOND",e[e.TRIANGLEUP="triangle-up"]="TRIANGLEUP",e[e.TRIANGLEDOWN="triangle-down"]="TRIANGLEDOWN"}(t.Shape||(t.Shape={}));t.Shape;!function(e){e[e.LEFT="left"]="LEFT",e[e.RIGHT="right"]="RIGHT",e[e.CENTER="center"]="CENTER"}(t.HorizontalAlign||(t.HorizontalAlign={}));t.HorizontalAlign;!function(e){e[e.TOP="top"]="TOP",e[e.MIDDLE="middle"]="MIDDLE",e[e.BOTTOM="bottom"]="BOTTOM"}(t.VerticalAlign||(t.VerticalAlign={}));var l=t.VerticalAlign;!function(e){e[e.NORMAL="normal"]="NORMAL",
e[e.ITALIC="italic"]="ITALIC"}(t.FontStyle||(t.FontStyle={}));t.FontStyle;!function(e){e[e.ZERO="zero"]="ZERO",e[e.CENTER="center"]="CENTER",e[e.NORMALIZE="normalize"]="NORMALIZE",e[e.NONE="none"]="NONE"}(t.StackOffset||(t.StackOffset={}));t.StackOffset;t.defaultMarkConfig={color:"#4682b4",strokeWidth:2,size:30,barThinSize:2,tickThickness:1,fontSize:10,baseline:l.MIDDLE,text:"Abc",shortTimeLabels:!1,applyColorToBackground:!1},t.defaultConfig={numberFormat:"s",timeFormat:"%Y-%m-%d",cell:t.defaultCellConfig,mark:t.defaultMarkConfig,scale:i.defaultScaleConfig,axis:a.defaultAxisConfig,legend:r.defaultLegendConfig,facet:t.defaultFacetConfig}},{"./axis":8,"./legend":34,"./scale":36}],31:[function(e,n,t){var i=e("./type");!function(e){e[e.JSON="json"]="JSON",e[e.CSV="csv"]="CSV",e[e.TSV="tsv"]="TSV"}(t.DataFormat||(t.DataFormat={}));t.DataFormat;t.SUMMARY="summary",t.SOURCE="source",t.STACKED_SCALE="stacked_scale",t.LAYOUT="layout",t.types={"boolean":i.Type.NOMINAL,number:i.Type.QUANTITATIVE,integer:i.Type.QUANTITATIVE,date:i.Type.TEMPORAL,string:i.Type.NOMINAL}},{"./type":41}],32:[function(e,n,t){function i(e){var n=0;return e.color&&n++,e.size&&n++,e.shape&&n++,n}function a(e){return s.CHANNELS.filter(function(n){return r(e,n)})}function r(e,n){var t=e&&e[n];return t&&(void 0!==t.field||d.isArray(t)&&t.length>0)}function o(e){return d.any(s.CHANNELS,function(n){return!(!r(e,n)||!e[n].aggregate)})}function l(e){var n=[];return s.CHANNELS.forEach(function(t){r(e,t)&&(d.isArray(e[t])?e[t].forEach(function(e){n.push(e)}):n.push(e[t]))}),n}function u(e,n,t){var i=0;s.CHANNELS.forEach(function(a){r(e,a)&&(d.isArray(e[a])?e[a].forEach(function(e){n.call(t,e,a,i++)}):n.call(t,e[a],a,i++))})}function c(e,n,t){var i=[];return s.CHANNELS.forEach(function(a){r(e,a)&&(d.isArray(e[a])?e[a].forEach(function(r){i.push(n.call(t,r,a,e))}):i.push(n.call(t,e[a],a,e)))}),i}function f(e,n,t,i){var a=t;return s.CHANNELS.forEach(function(t){r(e,t)&&(d.isArray(e[t])?e[t].forEach(function(r){a=n.call(i,a,r,t,e)}):a=n.call(i,a,e[t],t,e))}),a}var s=e("./channel"),d=e("./util");t.countRetinal=i,t.channels=a,t.has=r,t.isAggregate=o,t.fieldDefs=l,t.forEach=u,t.map=c,t.reduce=f},{"./channel":10,"./util":42}],33:[function(e,n,t){function i(e,n){void 0===n&&(n={});var t=(n.datum?"datum.":"")+(n.prefn||""),i=n.suffix||"",a=e.field;return u(e)?t+"count"+i:n.fn?t+n.fn+"_"+a+i:!n.nofn&&e.bin?t+"bin_"+a+(n.binSuffix||i||"_start"):n.nofn||n.noAggregate||!e.aggregate?!n.nofn&&e.timeUnit?t+e.timeUnit+"_"+a+i:t+a:t+e.aggregate+"_"+a+i}function a(e){return m.contains([p.NOMINAL,p.ORDINAL],e.type)||!!e.bin||e.type===p.TEMPORAL&&!!e.timeUnit}function r(e){return e&&e.field&&a(e)}function o(e){return e&&e.field&&!a(e)}function l(){return{field:"*",aggregate:s.AggregateOp.COUNT,type:p.QUANTITATIVE,displayName:t.COUNT_DISPLAYNAME}}function u(e){return e.aggregate===s.AggregateOp.COUNT}function c(e,n,t){void 0===t&&(t={});var i=n[e.field],a=e.type;if(e.bin){var r=e.bin,o="boolean"==typeof r?void 0:r.maxbins;void 0===o&&(o=10);var l=m.getbins(i,o);return(l.stop-l.start)/l.step}if(a===p.TEMPORAL){var u=e.timeUnit;switch(u){case d.TimeUnit.SECONDS:return 60;case d.TimeUnit.MINUTES:return 60;case d.TimeUnit.HOURS:return 24;case d.TimeUnit.DAY:return 7;case d.TimeUnit.DATE:return 31;case d.TimeUnit.MONTH:return 12;case d.TimeUnit.YEAR:var c=n["year_"+e.field];return c?c.distinct-(i.missing>0&&t[a]?1:0):null}}return e.aggregate?1:i.distinct-(i.missing>0&&t[a]?1:0)}function f(e){if(u(e))return t.COUNT_DISPLAYNAME;var n=e.aggregate||e.timeUnit||e.bin&&"bin";return n?n.toString().toUpperCase()+"("+e.field+")":e.field}var s=e("./aggregate"),d=e("./timeunit"),p=e("./type"),m=e("./util");t.aggregate={type:"string","enum":s.AGGREGATE_OPS,supportedEnums:{quantitative:s.AGGREGATE_OPS,ordinal:["median","min","max"],nominal:[],temporal:["mean","median","min","max"],"":["count"]},supportedTypes:m.toMap([p.QUANTITATIVE,p.NOMINAL,p.ORDINAL,p.TEMPORAL,""])},t.field=i,t.isDimension=r,t.isMeasure=o,t.COUNT_DISPLAYNAME="Number of Records",t.count=l,t.isCount=u,t.cardinality=c,t.title=f},{"./aggregate":7,"./timeunit":40,"./type":41,"./util":42}],34:[function(e,n,t){t.defaultLegendConfig={orient:void 0,shortTimeLabels:!1}},{}],35:[function(e,n,t){!function(e){e[e.AREA="area"]="AREA",e[e.BAR="bar"]="BAR",e[e.LINE="line"]="LINE",e[e.POINT="point"]="POINT",e[e.TEXT="text"]="TEXT",e[e.TICK="tick"]="TICK",e[e.CIRCLE="circle"]="CIRCLE",e[e.SQUARE="square"]="SQUARE"}(t.Mark||(t.Mark={}));var i=t.Mark;t.AREA=i.AREA,t.BAR=i.BAR,t.LINE=i.LINE,t.POINT=i.POINT,t.TEXT=i.TEXT,t.TICK=i.TICK,t.CIRCLE=i.CIRCLE,t.SQUARE=i.SQUARE},{}],36:[function(e,n,t){!function(e){e[e.LINEAR="linear"]="LINEAR",e[e.LOG="log"]="LOG",e[e.POW="pow"]="POW",e[e.SQRT="sqrt"]="SQRT",e[e.QUANTILE="quantile"]="QUANTILE",e[e.QUANTIZE="quantize"]="QUANTIZE",e[e.ORDINAL="ordinal"]="ORDINAL",e[e.TIME="time"]="TIME",e[e.UTC="utc"]="UTC"}(t.ScaleType||(t.ScaleType={}));t.ScaleType;!function(e){e[e.SECOND="second"]="SECOND",e[e.MINUTE="minute"]="MINUTE",e[e.HOUR="hour"]="HOUR",e[e.DAY="day"]="DAY",e[e.WEEK="week"]="WEEK",e[e.MONTH="month"]="MONTH",e[e.YEAR="year"]="YEAR"}(t.NiceTime||(t.NiceTime={}));t.NiceTime;t.defaultScaleConfig={round:!0,textBandWidth:90,bandSize:21,padding:1,includeRawDomain:!1,nominalColorRange:"category10",sequentialColorRange:["#AFC6A3","#09622A"],shapeRange:"shapes",fontSizeRange:[8,40]},t.defaultFacetScaleConfig={round:!0,padding:16}},{}],37:[function(e,n,t){function i(e){return"mark"+t.ASSIGN+e.mark+t.DELIM+r(e.encoding)}function a(e,n,i){var a=e.split(t.DELIM),r=a.shift().split(t.ASSIGN)[1].trim(),l=o(a.join(t.DELIM)),u={mark:m.Mark[r],encoding:l};return void 0!==n&&(u.data=n),void 0!==i&&(u.config=i),u}function r(e){return p.map(e,function(e,n){return n+t.ASSIGN+l(e)}).join(t.DELIM)}function o(e){return e.split(t.DELIM).reduce(function(e,n){var i=n.split(t.ASSIGN),a=i[0].trim(),r=i[1];return e[a]=c(r),e},{})}function l(e){return(e.aggregate?e.aggregate+t.FUNC:"")+(e.timeUnit?e.timeUnit+t.FUNC:"")+(e.bin?"bin"+t.FUNC:"")+(e.field||"")+t.TYPE+d.SHORT_TYPE[e.type]}function u(e,n){return void 0===n&&(n=t.DELIM),e.map(l).join(n)}function c(e){for(var n=e.split(t.TYPE),i={field:n[0].trim(),type:d.TYPE_FROM_SHORT_TYPE[n[1].trim()]},a=0;a<f.AGGREGATE_OPS.length;a++){var r=f.AGGREGATE_OPS[a];if(0===i.field.indexOf(r+"_")){i.field=i.field.substr(r.toString().length+1),r===f.AggregateOp.COUNT&&0===i.field.length&&(i.field="*"),i.aggregate=r;break}}for(var a=0;a<s.TIMEUNITS.length;a++){var o=s.TIMEUNITS[a];if(i.field&&0===i.field.indexOf(o+"_")){i.field=i.field.substr(i.field.length+1),i.timeUnit=o;break}}return i.field&&0===i.field.indexOf("bin_")&&(i.field=i.field.substr(4),i.bin=!0),i}var f=e("./aggregate"),s=e("./timeunit"),d=e("./type"),p=e("./encoding"),m=e("./mark");t.DELIM="|",t.ASSIGN="=",t.TYPE=",",t.FUNC="_",t.shorten=i,t.parse=a,t.shortenEncoding=r,t.parseEncoding=o,t.shortenFieldDef=l,t.shortenFieldDefs=u,t.parseFieldDef=c},{"./aggregate":7,"./encoding":32,"./mark":35,"./timeunit":40,"./type":41}],38:[function(e,n,t){!function(e){e[e.ASCENDING="ascending"]="ASCENDING",e[e.DESCENDING="descending"]="DESCENDING",e[e.NONE="none"]="NONE"}(t.SortOrder||(t.SortOrder={}));t.SortOrder},{}],39:[function(e,n,t){function i(e){return c.isAggregate(e.encoding)}function a(e){return c.fieldDefs(e.encoding)}function r(e){return e}function o(e){return(c.has(e.encoding,u.COLOR)||c.has(e.encoding,u.SHAPE))&&(e.mark===f.BAR||e.mark===f.AREA)&&(!e.config||!e.config.mark.stacked!=!1)&&c.isAggregate(e.encoding)}function l(e){var n=e.encoding,t=s.duplicate(e.encoding);return t.x=n.y,t.y=n.x,t.row=n.column,t.column=n.row,e.encoding=t,e}var u=e("./channel"),c=e("./encoding"),f=e("./mark"),s=e("./util");t.alwaysNoOcclusion=i,t.fieldDefs=a,t.getCleanSpec=r,t.isStack=o,t.transpose=l},{"./channel":10,"./encoding":32,"./mark":35,"./util":42}],40:[function(e,n,t){!function(e){e[e.YEAR="year"]="YEAR",e[e.MONTH="month"]="MONTH",e[e.DAY="day"]="DAY",e[e.DATE="date"]="DATE",e[e.HOURS="hours"]="HOURS",e[e.MINUTES="minutes"]="MINUTES",e[e.SECONDS="seconds"]="SECONDS",e[e.MILLISECONDS="milliseconds"]="MILLISECONDS",e[e.YEARMONTH="yearmonth"]="YEARMONTH",e[e.YEARMONTHDAY="yearmonthday"]="YEARMONTHDAY",e[e.YEARMONTHDATE="yearmonthdate"]="YEARMONTHDATE",e[e.YEARDAY="yearday"]="YEARDAY",e[e.YEARDATE="yeardate"]="YEARDATE",e[e.YEARMONTHDAYHOURS="yearmonthdayhours"]="YEARMONTHDAYHOURS",e[e.YEARMONTHDAYHOURSMINUTES="yearmonthdayhoursminutes"]="YEARMONTHDAYHOURSMINUTES",e[e.YEARMONTHDAYHOURSMINUTESSECONDS="yearmonthdayhoursminutesseconds"]="YEARMONTHDAYHOURSMINUTESSECONDS",e[e.HOURSMINUTES="hoursminutes"]="HOURSMINUTES",e[e.HOURSMINUTESSECONDS="hoursminutesseconds"]="HOURSMINUTESSECONDS",e[e.MINUTESSECONDS="minutesseconds"]="MINUTESSECONDS",e[e.SECONDSMILLISECONDS="secondsmilliseconds"]="SECONDSMILLISECONDS"}(t.TimeUnit||(t.TimeUnit={}));var i=t.TimeUnit;t.TIMEUNITS=[i.YEAR,i.MONTH,i.DAY,i.DATE,i.HOURS,i.MINUTES,i.SECONDS,i.MILLISECONDS,i.YEARMONTH,i.YEARMONTHDAY,i.YEARMONTHDATE,i.YEARDAY,i.YEARDATE,i.YEARMONTHDAYHOURS,i.YEARMONTHDAYHOURSMINUTES,i.YEARMONTHDAYHOURSMINUTESSECONDS,i.HOURSMINUTES,i.HOURSMINUTESSECONDS,i.MINUTESSECONDS,i.SECONDSMILLISECONDS]},{}],41:[function(e,n,t){function i(e){var n=e;return t.TYPE_FROM_SHORT_TYPE[n.toUpperCase()]||n.toLowerCase()}!function(e){e[e.QUANTITATIVE="quantitative"]="QUANTITATIVE",e[e.ORDINAL="ordinal"]="ORDINAL",e[e.TEMPORAL="temporal"]="TEMPORAL",e[e.NOMINAL="nominal"]="NOMINAL"}(t.Type||(t.Type={}));var a=t.Type;t.QUANTITATIVE=a.QUANTITATIVE,t.ORDINAL=a.ORDINAL,t.TEMPORAL=a.TEMPORAL,t.NOMINAL=a.NOMINAL,t.SHORT_TYPE={quantitative:"Q",temporal:"T",nominal:"N",ordinal:"O"},t.TYPE_FROM_SHORT_TYPE={Q:t.QUANTITATIVE,T:t.TEMPORAL,O:t.ORDINAL,N:t.NOMINAL},t.getFullName=i},{}],42:[function(e,n,t){function i(e,n){return e.indexOf(n)>-1}function a(e,n){return e.filter(function(e){return!i(n,e)})}function r(e,n,t){if(e.forEach)e.forEach.call(t,n);else for(var i in e)e.hasOwnProperty(i)&&n.call(t,e[i],i,e)}function o(e,n,t,i){if(e.reduce)return e.reduce.call(i,n,t);for(var a in e)e.hasOwnProperty(a)&&(t=n.call(i,t,e[a],a,e));return t}function l(e,n,t){if(e.map)return e.map.call(t,n);var i=[];for(var a in e)e.hasOwnProperty(a)&&i.push(n.call(t,e[a],a,e));return i}function u(e,n){for(var t=0,i=0;i<e.length;i++)if(n(e[i],i,t++))return!0;return!1}function c(e,n){for(var t=0,i=0;i<e.length;i++)if(!n(e[i],i,t++))return!1;return!0}function f(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];for(var i=0;i<n.length;i++)e=s(e,n[i]);return e}function s(e,n){if("object"!=typeof n||null===n)return e;for(var t in n)n.hasOwnProperty(t)&&void 0!==n[t]&&("object"!=typeof n[t]||null===n[t]?e[t]=n[t]:"object"!=typeof e[t]||null===e[t]?e[t]=f(n[t].constructor===Array?[]:{},n[t]):f(e[t],n[t]));return e}function d(e,n){return h({min:e.min,max:e.max,maxbins:n})}function p(e){console.error("[VL Error]",e)}var m=e("datalib/src/util");t.keys=m.keys,t.extend=m.extend,t.duplicate=m.duplicate,t.isArray=m.isArray,t.vals=m.vals,t.truncate=m.truncate,t.toMap=m.toMap,t.isObject=m.isObject;var g=e("datalib/src/generate");t.range=g.range,t.contains=i,t.without=a,t.forEach=r,t.reduce=o,t.map=l,t.any=u,t.all=c,t.mergeDeep=f;var h=e("datalib/src/bins/bins");t.getbins=d,t.error=p},{"datalib/src/bins/bins":3,"datalib/src/generate":4,"datalib/src/util":6}],43:[function(e,n,t){function i(e,n,i){void 0===n&&(n=t.DEFAULT_REQUIRED_CHANNEL_MAP),void 0===i&&(i=t.DEFAULT_SUPPORTED_CHANNEL_TYPE);var a=e.mark,o=e.encoding,l=n[a],u=i[a];for(var c in l)if(!(l[c]in o))return'Missing encoding channel "'+l[c]+'" for mark "'+a+'"';for(var f in o)if(!u[f])return'Encoding channel "'+f+'" is not supported by mark type "'+a+'"';return a!==r.BAR||o.x||o.y?null:"Missing both x and y for bar"}var a=e("./util"),r=e("./mark");t.DEFAULT_REQUIRED_CHANNEL_MAP={text:["text"],line:["x","y"],area:["x","y"]},t.DEFAULT_SUPPORTED_CHANNEL_TYPE={bar:a.toMap(["row","column","x","y","size","color","detail"]),line:a.toMap(["row","column","x","y","color","detail"]),area:a.toMap(["row","column","x","y","color","detail"]),tick:a.toMap(["row","column","x","y","color","detail"]),circle:a.toMap(["row","column","x","y","color","size","detail"]),square:a.toMap(["row","column","x","y","color","size","detail"]),point:a.toMap(["row","column","x","y","color","size","detail","shape"]),text:a.toMap(["row","column","size","color","text"])},t.getEncodingMappingError=i},{"./mark":35,"./util":42}],44:[function(e,n,t){var i=e("./bin"),a=e("./channel"),r=e("./data"),o=e("./encoding"),l=e("./fielddef"),u=e("./compile/compile"),c=e("./shorthand"),f=e("./spec"),s=e("./timeunit"),d=e("./type"),p=e("./validate"),m=e("./util");t.bin=i,t.channel=a,t.compile=u.compile,t.data=r,t.encoding=o,t.fieldDef=l,t.shorthand=c,t.spec=f,t.timeUnit=s,t.type=d,t.util=m,t.validate=p,t.version="1.0.8"},{"./bin":9,"./channel":10,"./compile/compile":14,"./data":31,"./encoding":32,"./fielddef":33,"./shorthand":37,"./spec":39,"./timeunit":40,"./type":41,"./util":42,"./validate":43}]},{},[44])(44)});
//# sourceMappingURL=vega-lite.min.js.map
